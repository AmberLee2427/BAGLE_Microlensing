<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model &mdash; BAGLE 0.1 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> BAGLE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">BAGLE TUTORIAL</a></li>
<li class="toctree-l1"><a class="reference internal" href="model3.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="PSPL_Param.html">POINT SOURCE POINT LENS (PSPL) CLASSES</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BAGLE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Model</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/model2.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-model">
<span id="model"></span><h1>Model<a class="headerlink" href="#module-model" title="Permalink to this headline">¶</a></h1>
<p>This set of classes and functions allows the user to construct microlensing
models built up from a menu of different features. Each model is built using
the inheritance of multiple classes, each from a different ‘family’ of
related classes.</p>
<dl class="simple">
<dt>Each microlensing model must contain:</dt><dd><ol class="arabic simple">
<li><dl class="simple">
<dt>A class from the Data Class Family</dt><dd><p><cite>PSPL</cite> – base class for all Data classes
<cite>PSPL_Phot</cite>
<cite>PSPL_PhotAstrom</cite>
<cite>PSPL_GP_Phot</cite>
<cite>PSPL_GP_PhotAstrom</cite></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>A class from the Parallax Class Family:</dt><dd><p><cite>PSPL_noParallax</cite>
<cite>PSPL_Parallax</cite></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>A class from the GP Class Family: (optional)</dt><dd><p><cite>PSPL_GP</cite></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>A class from the Parametrization Class Family:</dt><dd><p><cite>PSPL_Param</cite> – abstract base class for all Param classes
<cite>PSPL_PhotParam1</cite>
<cite>PSPL_PhotParam2</cite>
<cite>PSPL_PhotAstromParam1</cite>
<cite>PSPL_PhotAstromParam2</cite>
<cite>PSPL_PhotAstromParam3
`PSPL_GP_PhotParam1</cite>
<cite>PSPL_GP_PhotParam2</cite>
<cite>PSPL_GP_PhotAstromParam1</cite>
<cite>PSPL_GP_PhotAstromParam2</cite>
<cite>PSPL_GP_PhotAstromParam3</cite></p>
</dd>
</dl>
</li>
</ol>
</dd>
<dt>There is a parallax hierarchy for PSBL:</dt><dd><ol class="arabic simple">
<li><dl class="simple">
<dt>A class from the Data Class Family</dt><dd><p><cite>PSBL</cite> – base class for all Data classes
<cite>PSBL_Phot</cite>
<cite>PSBL_PhotAstrom</cite></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>A class from the Parallax Class Family:</dt><dd><p><cite>PSBL_noParallax</cite>
<cite>PSBL_Parallax</cite></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>A class from the Parametrization Class Family:</dt><dd><p><cite>PSBL_PhotParam1</cite>
<cite>PSBL_PhotAstromParam1</cite>
<cite>PSBL_PhotAstromParam2</cite>
<cite>PSBL_PhotAstromParam3</cite></p>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
<p>Several pre-built models are included in this file.</p>
<p>For example, the <cite>PSPL_PhotAstrom_noPar_Param1</cite> model is declared as:</p>
<blockquote>
<div><dl class="simple">
<dt>class PSPL_PhotAstrom_noPar_Param1(PSPL_PhotAstrom,</dt><dd><p>PSPL_noParallax,
PSPL_PhotAstromParam1)</p>
</dd>
</dl>
</div></blockquote>
<p>The words in the models name, and the classes used to declare it, tell us
what features the model contains. In this example, we can see that the model’s
name contains the words <cite>PhotAstrom</cite>, <cite>noPar</cite>, and <cite>Param1</cite>. From these words,
we know that this model (1) uses both photometry and astrometry data, (2) does
not include parallax in the model, and (3) uses the first
photometry / astrometry parameterization for declaring the model.</p>
<div class="section" id="class-families">
<h2>Class Families<a class="headerlink" href="#class-families" title="Permalink to this headline">¶</a></h2>
<div class="section" id="data-class-family">
<h3>Data Class Family<a class="headerlink" href="#data-class-family" title="Permalink to this headline">¶</a></h3>
<p>These classes inform the model of what type of data will be used by the model.
If the model will be for photometry only, then a model with the <cite>PSPL_Phot</cite>
class must be selected. These models have the words <cite>Phot</cite> in their names.
If the model will be using photometry and astrometry data, then a model with
the <cite>PSPL_PhotAstrom</cite> must be selected. These models have the words
<cite>PhotAstrom</cite> in their names.</p>
<p>Data containing astrometry will generate a warning that astrometry data will
not be used in the model when run through a model using <cite>PSPL_Phot</cite>. Data that
does not contain astrometry run through a model using <cite>PSPL_PhotAstrom</cite> will
generate a RuntimeError.</p>
</div>
<div class="section" id="parallax-class-family">
<h3>Parallax Class Family<a class="headerlink" href="#parallax-class-family" title="Permalink to this headline">¶</a></h3>
<p>These classes set whether the model uses parallax when calculating
photometry, calculating astrometry, and fitting data. There are only two
options for this class family, <cite>PSPL_noParallax</cite> and <cite>PSPL_Parallax</cite>. Models
that do not have parallax have the words <cite>noPar</cite> in their names, while models
that do contain parallax have the words <cite>Par</cite> in their names.</p>
</div>
<div class="section" id="parameterization-class-family">
<h3>Parameterization Class Family<a class="headerlink" href="#parameterization-class-family" title="Permalink to this headline">¶</a></h3>
<p>These classes determine which physical parameters define the model. Currently
this file supports one parameterization when using only photometry (<cite>Phot</cite>)
and three parametrizations when using photometry and astrometery
(<cite>PhotAstrom</cite>).</p>
<dl>
<dt>The parameters for each parameterization are:</dt><dd><dl>
<dt>PhotParam1 :</dt><dd><p>Point source point lens model for microlensing photometry only.
This model includes the relative proper motion between the lens
and the source. Parameters are reduced with the use of piRel</p>
<dl class="simple">
<dt>Parameters: t0, u0_amp, tE,</dt><dd><p>piE_E, piE_N,
b_sff, mag_src,
(ra, dec)</p>
</dd>
</dl>
</dd>
<dt>PhotAstromParam1 :</dt><dd><p>Point Source Point Lens model for microlensing. This model includes
proper motions of both the lens and source.</p>
<dl class="simple">
<dt>Parameters: mL, t0, beta, dL, dL_dS,</dt><dd><p>xS0_E, xS0_N,
muL_E, muL_N,
muS_E, muS_N,
b_sff, mag_src,
(ra, dec)</p>
</dd>
</dl>
</dd>
<dt>PhotAstromParam2 :</dt><dd><p>Point Source Point Lens model for microlensing. This model includes
proper motions of the source and the source position on the sky.</p>
<dl class="simple">
<dt>Parameters: t0, u0_amp, tE, thetaE, piS,</dt><dd><p>piE_E, piE_N,
xS0_E, xS0_N,
muS_E, muS_N,
b_sff, mag_src,
(ra, dec)</p>
</dd>
</dl>
</dd>
<dt>PhotAstromParam3 :</dt><dd><p>Point Source Point Lens model for microlensing. This model includes
proper motions of the source and the source position on the sky.
Note it fits the baseline magnitude rather than the unmagnified source 
brightness.</p>
<dl class="simple">
<dt>Parameters: t0, u0_amp, tE, log10_thetaE, piS,</dt><dd><p>piE_E, piE_N,
xS0_E, xS0_N,
muS_E, muS_N,
b_sff, mag_base,
(ra, dec)</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>(ra, dec) are only required if the model is created with a parallax class.
More details about each parameterization can be found in the Parameterization
Class docstring.</p>
</div>
<div class="section" id="making-a-new-model">
<h3>Making a New Model<a class="headerlink" href="#making-a-new-model" title="Permalink to this headline">¶</a></h3>
<p>Each model is, as described above, constructed by combining inheriting from
different parent classes that contain the desired features for the model. Each
model must have one class from each class family. In addition to this, there
are several rules that must be followed when creating a new class.</p>
<blockquote>
<div><ol class="arabic">
<li><p>The data class must match the parameterization class. For example,
if the chosen data class is <cite>PSPL_Phot</cite>, then the parameter class
must be <cite>PSPL_PhotParam1</cite> (or a different PhotParam in a future
version). If the data class is <cite>PSPL_PhotAstrom</cite>, then the parameter
class must be one of the classes with a PhotAstromParam.</p></li>
<li><p>Models are built using python’s multiple inheritance feature. Therefore
the order in which the parent classes are listed in the model class’
definition matters. Parent classes to models should always be listed
in the order:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Data Class</p></li>
<li><p>Parallax Class</p></li>
<li><p>Parameterization Class</p></li>
</ol>
</div></blockquote>
<dl class="simple">
<dt>If using the optional GP class, then the order is</dt><dd><ol class="loweralpha simple">
<li><p>GP Class</p></li>
<li><p>Data Class</p></li>
<li><p>Parallax Class</p></li>
<li><p>Parameterization Class</p></li>
</ol>
</dd>
</dl>
</li>
<li><p>Each class must be given the <cite>&#64;inheritdocstring</cite> decorator, and include
the following commands in the model’s <cite>__init__</cite>:</p>
<blockquote>
<div><p>super().__init__(<a href="#id1"><span class="problematic" id="id2">*</span></a>args, <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs)
startbases(self)
checkconflicts(self)</p>
</div></blockquote>
<dl>
<dt>Each of these performs the following function:</dt><dd><dl>
<dt><cite>super().__init__(*args, **kwargs)</cite><span class="classifier">Inherits the __init__ form</span></dt><dd><p>the Parameterization Class.</p>
</dd>
<dt><cite>startbases(self)</cite><span class="classifier">Runs a <cite>start</cite> command on each parent class,</span></dt><dd><p>giving each parent class a chance to run a
set of functions upon instantiation.</p>
</dd>
<dt><cite>checkconflicts(self)</cite><span class="classifier">Checks to confirm that the combination of</span></dt><dd><p>parent classes in the model are valid.</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><p>Models should be named to reflect the parents classes used to construct
it, as outlined in the above sections.</p></li>
</ol>
</div></blockquote>
<dl class="py class">
<dt id="model.PSPL_Param">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Param</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Param" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_AstromParam4">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_AstromParam4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thetaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_AstromParam4" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>DESCRIPTION:
Point Source Point Lens model for microlensing. This model includes
proper motions of the source and the source position on the sky.
It is the same as PSPL_PhotAstromParam2 except it fits for baseline instead
of source magnitude.</p>
<p>t0: Time of photometric peak, as seen from Earth (MJD.DDD)
u0_amp: Angular distance between the lens and source on the plane of the</p>
<blockquote>
<div><dl class="simple">
<dt>sky at closest approach in units of thetaE. Can be</dt><dd><p>positive (u0_amp &gt; 0 when u0_hat[0] &gt; 0) or 
negative (u0_amp &lt; 0 when u0_hat[0] &lt; 0).</p>
</dd>
</dl>
</div></blockquote>
<p>tE: Einstein crossing time (days).
thetaE: The size of the Einstein radius in (mas).
piS: Amplitude of the parallax (1AU/dS) of the source. (mas)
piE_E: The microlensing parallax in the East direction in units of thetaE
piE_N: The microlensing parallax in the North direction in units of thetaE
xS0_E: RA Source position on sky at t = t0 (arcsec) in an arbitrary ref. frame.
xS0_N: Dec source position on sky at t = t0 (arcsec) in an arbitrary ref. frame.
muS_E: RA Source proper motion (mas/yr)
muS_N: Dec Source proper motion (mas/yr)
== Required if calculating with parallax ==
raL: Right ascension of the lens in decimal degrees.
decL: Declination of the lens in decimal degrees.
###############################################################################</p>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_AstromParam3">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_AstromParam3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log10_thetaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_AstromParam3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>DESCRIPTION:
Point Source Point Lens model for microlensing. This model includes
proper motions of the source and the source position on the sky.
It is the same as PSPL_PhotAstromParam3 except it fits only astrometry, no
photometry.</p>
<p>t0: Time of photometric peak, as seen from Earth (MJD.DDD)
u0_amp: Angular distance between the lens and source on the plane of the</p>
<blockquote>
<div><dl class="simple">
<dt>sky at closest approach in units of thetaE. Can be</dt><dd><p>positive (u0_amp &gt; 0 when u0_hat[0] &gt; 0) or 
negative (u0_amp &lt; 0 when u0_hat[0] &lt; 0).</p>
</dd>
</dl>
</div></blockquote>
<p>tE: Einstein crossing time (days).
log10_thetaE: The log of the Einstein radius log10(thetaE/mas).
piS: Amplitude of the parallax (1AU/dS) of the source. (mas)
piE_E: The microlensing parallax in the East direction in units of thetaE
piE_N: The microlensing parallax in the North direction in units of thetaE
xS0_E: RA Source position on sky at t = t0 (arcsec) in an arbitrary ref. frame.
xS0_N: Dec source position on sky at t = t0 (arcsec) in an arbitrary ref. frame.
muS_E: RA Source proper motion (mas/yr)
muS_N: Dec Source proper motion (mas/yr)
== Required if calculating with parallax ==
raL: Right ascension of the lens in decimal degrees.
decL: Declination of the lens in decimal degrees.
###############################################################################</p>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotParam1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotParam1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotParam1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>PSPL model for photometry only.</p>
<p>Point source point lens model for microlensing photometry only.
This model includes the relative proper motion between the lens
and the source. Parameters are reduced with the use of piRel
(rather than dL and dS) and muRel (rather than muL and muS).</p>
<p>Note the attributes, RA (raL) and Dec (decL) are required 
if you are calculating a model with parallax.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t0: float</strong></dt><dd><p>Time of photometric peak, as seen from Earth (MJD.DDD)</p>
</dd>
<dt><strong>u0_amp: float</strong></dt><dd><p>Angular distance between the lens and source on the plane of the
sky at closest approach in units of thetaE. It can be
positive (u0_amp &gt; 0 when u0_hat[0] &gt; 0) or 
negative (u0_amp &lt; 0 when u0_hat[0] &lt; 0).</p>
</dd>
<dt><strong>tE: float</strong></dt><dd><p>Einstein crossing time in days.</p>
</dd>
<dt><strong>piE_E: float</strong></dt><dd><p>The microlensing parallax in the East direction in units of thetaE.</p>
</dd>
<dt><strong>piE_N: float</strong></dt><dd><p>The microlensing parallax in the North direction in units of thetaE</p>
</dd>
<dt><strong>b_sff: float</strong></dt><dd><p>The ratio of the source flux to the total (source + neighbors + lens)
b_sff = f_S / (f_S + f_L + f_N). This must be passed in as a list or
array, with one entry for each photometric filter.</p>
</dd>
<dt><strong>mag_src: float</strong></dt><dd><p>Photometric magnitude of the source. This must be passed in as a
list or array, with one entry for each photometric filter.</p>
</dd>
<dt><strong>raL: float, optional</strong></dt><dd><p>Right ascension of the lens in decimal degrees.</p>
</dd>
<dt><strong>decL: float, optional</strong></dt><dd><p>Declination of the lens in decimal degrees.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotParam2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotParam2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotParam2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>DESCRIPTION:
Point source point lens model for microlensing photometry only.
This model includes the relative proper motion between the lens
and the source. Parameters are reduced with the use of piRel
(rather than dL and dS) and muRel (rather than muL and muS).
Same as PSPL_PhotParam1, except fits for mag_base instead of 
mag_src.</p>
<p>t0: Time of photometric peak, as seen from Earth (MJD.DDD)
u0_amp: Angular distance between the lens and source on the plane of the</p>
<blockquote>
<div><p>sky at closest approach in units of thetaE. It can be
positive (u0_amp &gt; 0 when u0_hat[0] &gt; 0) or 
negative (u0_amp &lt; 0 when u0_hat[0] &lt; 0).</p>
</div></blockquote>
<p>tE: Einstein crossing time.
piE_E: The microlensing parallax in the East direction in units of thetaE
piE_N: The microlensing parallax in the North direction in units of thetaE
b_sff: The ratio of the source flux to the total (source + neighbors + lens)</p>
<blockquote>
<div><p>b_sff = f_S / (f_S + f_L + f_N). This must be passed in as a list or
array, with one entry for each photometric filter.</p>
</div></blockquote>
<dl class="simple">
<dt>mag_base: Photometric magnitude of the base. This must be passed in as a</dt><dd><p>list or array, with one entry for each photometric filter.</p>
</dd>
</dl>
<p>== Required if calculating with parallax ==
raL: Right ascension of the lens in decimal degrees.
decL: Declination of the lens in decimal degrees.
############################################################</p>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstromParam1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstromParam1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dL_dS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muL_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muL_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstromParam1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>PSPL model for astrometry and photometry - physical parameterization.</p>
<p>A Point Source Point Lens model for microlensing. This model uses a 
parameterization that depends on only physical quantities such as the 
lens mass and positions and proper motions of both the lens and source.</p>
<p>Note the attributes, RA (raL) and Dec (decL) are required 
if you are calculating a model with parallax.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mL: float</strong></dt><dd><p>Mass of the lens (Msun)</p>
</dd>
<dt><strong>t0: float</strong></dt><dd><p>Time of photometric peak, as seen from Earth (MJD.DDD)</p>
</dd>
<dt><strong>beta: float</strong></dt><dd><p>Angular distance between the lens and source on the plane of the sky (mas). Can be
positive (u0_amp &gt; 0 when u0_hat[0] &lt; 0) or 
negative (u0_amp &lt; 0 when u0_hat[0] &gt; 0).</p>
</dd>
<dt><strong>dL: float</strong></dt><dd><p>Distance from the observer to the lens (pc)</p>
</dd>
<dt><strong>dL_dS: float</strong></dt><dd><p>Ratio of Distance from the obersver to the lens to
Distance from the observer to the source</p>
</dd>
<dt><strong>xS0_E: float</strong></dt><dd><p>RA Source position on sky at t = t0 (arcsec) in an arbitrary ref. frame.</p>
</dd>
<dt><strong>xS0_N: float</strong></dt><dd><p>Dec source position on sky at t = t0 (arcsec) in an arbitrary ref. frame.</p>
</dd>
<dt><strong>muL_E: float</strong></dt><dd><p>RA Lens proper motion (mas/yr)</p>
</dd>
<dt><strong>muL_N: float</strong></dt><dd><p>Dec Lens proper motion (mas/yr)</p>
</dd>
<dt><strong>muS_E: float</strong></dt><dd><p>RA Source proper motion (mas/yr)</p>
</dd>
<dt><strong>muS_N: float</strong></dt><dd><p>Dec Source proper motion (mas/yr)</p>
</dd>
<dt><strong>b_sff: float</strong></dt><dd><p>The ratio of the source flux to the total (source + neighbors + lens)
b_sff = f_S / (f_S + f_L + f_N). This must be passed in as a list or
array, with one entry for each photometric filter.</p>
</dd>
<dt><strong>mag_src: float</strong></dt><dd><p>Photometric magnitude of the source. This must be passed in as a
list or array, with one entry for each photometric filter.</p>
</dd>
<dt><strong>raL: float, optional</strong></dt><dd><p>Right ascension of the lens in decimal degrees.</p>
</dd>
<dt><strong>decL: float, optional</strong></dt><dd><p>Declination of the lens in decimal degrees.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstromParam2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstromParam2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thetaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstromParam2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>PSPL model for photometry and astrometry – photom-like parameterization</p>
<p>Point Source Point Lens model for microlensing. This model includes
proper motions of the source and the source position on the sky.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t0: Time of photometric peak, as seen from Earth (MJD.DDD)</strong></dt><dd></dd>
<dt><strong>u0_amp: Angular distance between the lens and source on the plane of the</strong></dt><dd><dl class="simple">
<dt>sky at closest approach in units of thetaE. Can be</dt><dd><p>positive (u0_amp &gt; 0 when u0_hat[0] &gt; 0) or 
negative (u0_amp &lt; 0 when u0_hat[0] &lt; 0).</p>
</dd>
</dl>
</dd>
<dt><strong>tE: Einstein crossing time (days).</strong></dt><dd></dd>
<dt><strong>thetaE: The size of the Einstein radius in (mas).</strong></dt><dd></dd>
<dt><strong>piS: Amplitude of the parallax (1AU/dS) of the source. (mas)</strong></dt><dd></dd>
<dt><strong>piE_E: The microlensing parallax in the East direction in units of thetaE</strong></dt><dd></dd>
<dt><strong>piE_N: The microlensing parallax in the North direction in units of thetaE</strong></dt><dd></dd>
<dt><strong>xS0_E: RA Source position on sky at t = t0 (arcsec) in an arbitrary ref. frame.</strong></dt><dd></dd>
<dt><strong>xS0_N: Dec source position on sky at t = t0 (arcsec) in an arbitrary ref. frame.</strong></dt><dd></dd>
<dt><strong>muS_E: RA Source proper motion (mas/yr)</strong></dt><dd></dd>
<dt><strong>muS_N: Dec Source proper motion (mas/yr)</strong></dt><dd></dd>
<dt><strong>b_sff: The ratio of the source flux to the total (source + neighbors + lens)</strong></dt><dd><p>b_sff = f_S / (f_S + f_L + f_N). This must be passed in as a list or
array, with one entry for each photometric filter.</p>
</dd>
<dt><strong>mag_src: Photometric magnitude of the source. This must be passed in as a</strong></dt><dd><p>list or array, with one entry for each photometric filter.</p>
</dd>
<dt><strong>raL: float, optional</strong></dt><dd><p>Right ascension of the lens in decimal degrees.</p>
</dd>
<dt><strong>decL: float, optional</strong></dt><dd><p>Declination of the lens in decimal degrees.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstromParam3">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstromParam3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log10_thetaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstromParam3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>DESCRIPTION:
Point Source Point Lens model for microlensing. This model includes
proper motions of the source and the source position on the sky.
It is the same as PSPL_PhotAstromParam4 except it fits for log10(thetaE)
instead of thetaE.</p>
<dl>
<dt>t0<span class="classifier">float</span></dt><dd><p>Time of photometric peak, as seen from Earth (MJD.DDD)</p>
</dd>
<dt>u0_amp<span class="classifier">float</span></dt><dd><p>Angular distance between the source and the GEOMETRIC center of the lenses
on the plane of the sky at closest approach in units of thetaE. Can</p>
<blockquote>
<div><p>positive (u0_amp &gt; 0 when u0_hat[0] &gt; 0) or 
negative (u0_amp &lt; 0 when u0_hat[0] &lt; 0).</p>
</div></blockquote>
</dd>
<dt>tE<span class="classifier">float</span></dt><dd><p>Einstein crossing time (days).</p>
</dd>
<dt>log10_thetaE<span class="classifier">float</span></dt><dd><p>The size of the Einstein radius in (mas).</p>
</dd>
<dt>piS<span class="classifier">float</span></dt><dd><p>Amplitude of the parallax (1AU/dS) of the source. (mas)</p>
</dd>
<dt>piE_E<span class="classifier">float</span></dt><dd><p>The microlensing parallax in the East direction in units of thetaE</p>
</dd>
<dt>piE_N<span class="classifier">float</span></dt><dd><p>The microlensing parallax in the North direction in units of thetaE</p>
</dd>
<dt>xS0_E<span class="classifier">float</span></dt><dd><p>R.A. of source position on sky at t = t0 (arcsec) in an
arbitrary ref. frame.</p>
</dd>
<dt>xS0_N<span class="classifier">float</span></dt><dd><p>Dec. of source position on sky at t = t0 (arcsec) in an
arbitrary ref. frame.</p>
</dd>
<dt>muS_E<span class="classifier">float</span></dt><dd><p>RA Source proper motion (mas/yr)</p>
</dd>
<dt>muS_N<span class="classifier">float</span></dt><dd><p>Dec Source proper motion (mas/yr)</p>
</dd>
<dt>b_sff<span class="classifier">numpy array or list</span></dt><dd><p>The ratio of the source flux to the total (source + neighbors + lenses). One
for each filter.</p>
<blockquote>
<div><p>b_sff = f_S / (f_S + f_L + f_N).</p>
</div></blockquote>
<p>This must be passed in as a list or
array, with one entry for each photometric filter.</p>
</dd>
<dt>mag_base<span class="classifier">numpy array or list</span></dt><dd><p>Photometric magnitude of the base. This must be passed in as a
list or array, with one entry for each photometric filter.</p>
</dd>
</dl>
<p>== Required if calculating with parallax ==
raL: Right ascension of the lens in decimal degrees.
decL: Declination of the lens in decimal degrees.
###############################################################################</p>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstromParam4">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstromParam4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thetaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstromParam4" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>DESCRIPTION:
Point Source Point Lens model for microlensing. This model includes
proper motions of the source and the source position on the sky.
It is the same as PSPL_PhotAstromParam2 except it fits for baseline instead
of source magnitude.</p>
<p>t0: Time of photometric peak, as seen from Earth (MJD.DDD)
u0_amp: Angular distance between the lens and source on the plane of the</p>
<blockquote>
<div><dl class="simple">
<dt>sky at closest approach in units of thetaE. Can be</dt><dd><p>positive (u0_amp &gt; 0 when u0_hat[0] &gt; 0) or 
negative (u0_amp &lt; 0 when u0_hat[0] &lt; 0).</p>
</dd>
</dl>
</div></blockquote>
<p>tE: Einstein crossing time (days).
thetaE: The size of the Einstein radius in (mas).
piS: Amplitude of the parallax (1AU/dS) of the source. (mas)
piE_E: The microlensing parallax in the East direction in units of thetaE
piE_N: The microlensing parallax in the North direction in units of thetaE
xS0_E: RA Source position on sky at t = t0 (arcsec) in an arbitrary ref. frame.
xS0_N: Dec source position on sky at t = t0 (arcsec) in an arbitrary ref. frame.
muS_E: RA Source proper motion (mas/yr)
muS_N: Dec Source proper motion (mas/yr)
b_sff: The ratio of the source flux to the total (source + neighbors + lens)</p>
<blockquote>
<div><p>b_sff = f_S / (f_S + f_L + f_N). This must be passed in as a list or
array, with one entry for each photometric filter.</p>
</div></blockquote>
<dl class="simple">
<dt>mag_base: Photometric magnitude of the base. This must be passed in as a</dt><dd><p>list or array, with one entry for each photometric filter.</p>
</dd>
</dl>
<p>== Required if calculating with parallax ==
raL: Right ascension of the lens in decimal degrees.
decL: Declination of the lens in decimal degrees.
###############################################################################</p>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_GP_PhotParam1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_GP_PhotParam1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_S0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_GP_PhotParam1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotParam1" title="model.PSPL_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotParam1</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_GP_PhotParam1_2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_GP_PhotParam1_2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega04_S0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_GP_PhotParam1_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotParam1" title="model.PSPL_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotParam1</span></code></a></p>
<p>Figuring out the new prior parametrization.</p>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_GP_PhotParam2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_GP_PhotParam2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_S0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_GP_PhotParam2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotParam2" title="model.PSPL_PhotParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotParam2</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_GP_PhotParam2_2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_GP_PhotParam2_2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega04_S0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_GP_PhotParam2_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotParam2" title="model.PSPL_PhotParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotParam2</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_GP_PhotAstromParam1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_GP_PhotAstromParam1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dL_dS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muL_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muL_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega04_S0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_GP_PhotAstromParam1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstromParam1" title="model.PSPL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam1</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_GP_PhotAstromParam2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_GP_PhotAstromParam2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thetaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega04_S0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_GP_PhotAstromParam2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstromParam2" title="model.PSPL_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam2</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_GP_PhotAstromParam3">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_GP_PhotAstromParam3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log10_thetaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega04_S0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_GP_PhotAstromParam3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstromParam3" title="model.PSPL_PhotAstromParam3"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam3</span></code></a></p>
<blockquote>
<div><p>Point Source Point Lens with GP model for microlensing. This model includes
proper motions of the source and the source position on the sky.
It is the same as PSPL_PhotAstromParam4 except it fits for log10(thetaE)
instead of thetaE.</p>
</div></blockquote>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_GP_PhotAstromParam4">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_GP_PhotAstromParam4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thetaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega04_S0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_GP_PhotAstromParam4" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstromParam4" title="model.PSPL_PhotAstromParam4"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam4</span></code></a></p>
<blockquote>
<div><p>Point Source Point Lens with GP model for microlensing. This model includes
proper motions of the source and the source position on the sky.
It is the same as PSPL_PhotAstromParam2 except it fits for baseline instead
of source magnitude.</p>
</div></blockquote>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Phot">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Phot</span></code><a class="headerlink" href="#model.PSPL_Phot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSPL.html#model.PSPL" title="model.PSPL"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL</span></code></a></p>
<p>Contains methods for model a PSPL photometry only.
This is a Data-type class in our hierarchy. It is abstract and should not
be instantiated.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot.animate" title="model.PSPL_Phot.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_astrometry_unlensed</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Phot.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom</span></code><a class="headerlink" href="#model.PSPL_PhotAstrom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSPL.html#model.PSPL" title="model.PSPL"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL</span></code></a></p>
<p>Contains methods for model a PSPL photometry + astrometry.
This is a Data-type class in our hierarchy. It is abstract and should not
be instantiated.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom.animate" title="model.PSPL_PhotAstrom.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Astrom">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Astrom</span></code><a class="headerlink" href="#model.PSPL_Astrom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSPL.html#model.PSPL" title="model.PSPL"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL</span></code></a></p>
<p>Contains methods for model a PSPL photometry + astrometry.
This is a Data-type class in our hierarchy. It is abstract and should not
be instantiated.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Astrom.animate" title="model.PSPL_Astrom.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Astrom.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.Celerite_GP_Model">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">Celerite_GP_Model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pspl_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">celerite.modeling.Model</span></code></p>
<p>This is nedeed for the GP.
Just a wrapper over our model so it is a 
celerite model.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#model.Celerite_GP_Model.full_size" title="model.Celerite_GP_Model.full_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">full_size</span></code></a></dt><dd><p>The total number of parameters (including frozen parameters)</p>
</dd>
<dt><a class="reference internal" href="#model.Celerite_GP_Model.parameter_vector" title="model.Celerite_GP_Model.parameter_vector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameter_vector</span></code></a></dt><dd><p>An array of all parameters (including frozen parameters)</p>
</dd>
<dt><a class="reference internal" href="#model.Celerite_GP_Model.vector_size" title="model.Celerite_GP_Model.vector_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_size</span></code></a></dt><dd><p>The number of active (or unfrozen) parameters</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.compute_gradient" title="model.Celerite_GP_Model.compute_gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_gradient</span></code></a>(*args, **kwargs)</p></td>
<td><p>Compute the “gradient” of the model for the current parameters</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.freeze_all_parameters" title="model.Celerite_GP_Model.freeze_all_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">freeze_all_parameters</span></code></a>()</p></td>
<td><p>Freeze all parameters of the model</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.freeze_parameter" title="model.Celerite_GP_Model.freeze_parameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">freeze_parameter</span></code></a>(name)</p></td>
<td><p>Freeze a parameter by name</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.get_parameter" title="model.Celerite_GP_Model.get_parameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code></a>(name)</p></td>
<td><p>Get a parameter value by name</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.get_parameter_bounds" title="model.Celerite_GP_Model.get_parameter_bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter_bounds</span></code></a>([include_frozen])</p></td>
<td><p>Get a list of the parameter bounds</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.get_parameter_dict" title="model.Celerite_GP_Model.get_parameter_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter_dict</span></code></a>([include_frozen])</p></td>
<td><p>Get an ordered dictionary of the parameters</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.get_parameter_names" title="model.Celerite_GP_Model.get_parameter_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter_names</span></code></a>([include_frozen])</p></td>
<td><p>Get a list of the parameter names</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.get_parameter_vector" title="model.Celerite_GP_Model.get_parameter_vector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter_vector</span></code></a>([include_frozen])</p></td>
<td><p>Get an array of the parameter values in the correct order</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.get_value" title="model.Celerite_GP_Model.get_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_value</span></code></a>(t_obs)</p></td>
<td><p>Compute the “value” of the model for the current parameters</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.log_prior" title="model.Celerite_GP_Model.log_prior"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_prior</span></code></a>()</p></td>
<td><p>Compute the log prior probability of the current parameters</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.set_parameter" title="model.Celerite_GP_Model.set_parameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_parameter</span></code></a>(name, value)</p></td>
<td><p>Set a parameter value by name</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.set_parameter_vector" title="model.Celerite_GP_Model.set_parameter_vector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_parameter_vector</span></code></a>(vector[, include_frozen])</p></td>
<td><p>Set the parameter values to the given vector</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.thaw_all_parameters" title="model.Celerite_GP_Model.thaw_all_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">thaw_all_parameters</span></code></a>()</p></td>
<td><p>Thaw all parameters of the model</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.Celerite_GP_Model.thaw_parameter" title="model.Celerite_GP_Model.thaw_parameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">thaw_parameter</span></code></a>(name)</p></td>
<td><p>Thaw a parameter by name</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_gradient</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.Celerite_GP_Model.get_value">
<code class="sig-name descname"><span class="pre">get_value</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.get_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the “value” of the model for the current parameters</p>
<p>This method should be overloaded by subclasses to implement the actual
functionality of the model.</p>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.compute_gradient">
<code class="sig-name descname"><span class="pre">compute_gradient</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.compute_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the “gradient” of the model for the current parameters</p>
<p>This method should be overloaded by subclasses to implement the actual
functionality of the model. The output of this function should be an
array where the first dimension is <code class="docutils literal notranslate"><span class="pre">full_size</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.freeze_all_parameters">
<code class="sig-name descname"><span class="pre">freeze_all_parameters</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.freeze_all_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Freeze all parameters of the model</p>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.freeze_parameter">
<code class="sig-name descname"><span class="pre">freeze_parameter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.freeze_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Freeze a parameter by name</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name: The name of the parameter</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.full_size">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">full_size</span></code><a class="headerlink" href="#model.Celerite_GP_Model.full_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of parameters (including frozen parameters)</p>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.get_parameter">
<code class="sig-name descname"><span class="pre">get_parameter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.get_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a parameter value by name</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name: The name of the parameter</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.get_parameter_bounds">
<code class="sig-name descname"><span class="pre">get_parameter_bounds</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.get_parameter_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of the parameter bounds</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>include_frozen (Optional[bool]): Should the frozen parameters be</dt><dd><p>included in the returned value? (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.get_parameter_dict">
<code class="sig-name descname"><span class="pre">get_parameter_dict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.get_parameter_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an ordered dictionary of the parameters</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>include_frozen (Optional[bool]): Should the frozen parameters be</dt><dd><p>included in the returned value? (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.get_parameter_names">
<code class="sig-name descname"><span class="pre">get_parameter_names</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.get_parameter_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of the parameter names</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>include_frozen (Optional[bool]): Should the frozen parameters be</dt><dd><p>included in the returned value? (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.get_parameter_vector">
<code class="sig-name descname"><span class="pre">get_parameter_vector</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.get_parameter_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an array of the parameter values in the correct order</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>include_frozen (Optional[bool]): Should the frozen parameters be</dt><dd><p>included in the returned value? (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.log_prior">
<code class="sig-name descname"><span class="pre">log_prior</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.log_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log prior probability of the current parameters</p>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.parameter_vector">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">parameter_vector</span></code><a class="headerlink" href="#model.Celerite_GP_Model.parameter_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>An array of all parameters (including frozen parameters)</p>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.set_parameter">
<code class="sig-name descname"><span class="pre">set_parameter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.set_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a parameter value by name</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name: The name of the parameter
value (float): The new value for the parameter</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.set_parameter_vector">
<code class="sig-name descname"><span class="pre">set_parameter_vector</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.set_parameter_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameter values to the given vector</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>vector (array[vector_size] or array[full_size]): The target</dt><dd><p>parameter vector. This must be in the same order as
<code class="docutils literal notranslate"><span class="pre">parameter_names</span></code> and it should only include frozen
parameters if <code class="docutils literal notranslate"><span class="pre">include_frozen</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt>include_frozen (Optional[bool]): Should the frozen parameters be</dt><dd><p>included in the returned value? (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.thaw_all_parameters">
<code class="sig-name descname"><span class="pre">thaw_all_parameters</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.thaw_all_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Thaw all parameters of the model</p>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.thaw_parameter">
<code class="sig-name descname"><span class="pre">thaw_parameter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.Celerite_GP_Model.thaw_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Thaw a parameter by name</p>
<dl class="simple">
<dt>Args:</dt><dd><p>name: The name of the parameter</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.Celerite_GP_Model.vector_size">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">vector_size</span></code><a class="headerlink" href="#model.Celerite_GP_Model.vector_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of active (or unfrozen) parameters</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_GP">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_GP</span></code><a class="headerlink" href="#model.PSPL_GP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>PSPL object that has optional support for gaussian process on each photometric filter.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_GP.get_log_det_covariance" title="model.PSPL_GP.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_GP.get_photometry_with_gp" title="model.PSPL_GP.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_GP.log_likely_photometry" title="model.PSPL_GP.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_GP.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_GP.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_GP.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_GP.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_GP.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_GP.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL</span></code><a class="headerlink" href="#model.PSBL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSPL.html#model.PSPL" title="model.PSPL"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL</span></code></a></p>
<p>Contains methods for model a PSBL photometry + astrometry.
This is a Data-type class in our hierarchy. It is abstract and should not
be instantiated.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL.animate" title="model.PSBL.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL.get_all_arrays" title="model.PSBL.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL.get_amp_arr" title="model.PSBL.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id5"><span class="problematic" id="id6">|J|</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL.get_image_pos_arr" title="model.PSBL.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL.get_photometry" title="model.PSBL.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL.get_resolved_photometry" title="model.PSBL.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id7"><span class="problematic" id="id8">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_Phot">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_Phot</span></code><a class="headerlink" href="#model.PSBL_Phot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSBL" title="model.PSBL"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL</span></code></a>, <a class="reference internal" href="#model.PSPL_Phot" title="model.PSPL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Phot</span></code></a></p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot.animate" title="model.PSBL_Phot.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot.get_all_arrays" title="model.PSBL_Phot.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot.get_amp_arr" title="model.PSBL_Phot.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id9"><span class="problematic" id="id10">|J|</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot.get_astrometry" title="model.PSBL_Phot.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in Einstein radii.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot.get_astrometry_unlensed" title="model.PSBL_Phot.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot.get_complex_pos" title="model.PSBL_Phot.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot.get_image_pos_arr" title="model.PSBL_Phot.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot.get_photometry" title="model.PSBL_Phot.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot.get_resolved_astrometry" title="model.PSBL_Phot.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in Einstein radii.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot.get_resolved_lens_astrometry" title="model.PSBL_Phot.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot.get_resolved_photometry" title="model.PSBL_Phot.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_Phot.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.
Note, this is a photometry only model, so units are in Einstein radii.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.
Note, this is a photometry only model, so units are in Einstein radii.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id11"><span class="problematic" id="id12">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstrom">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstrom</span></code><a class="headerlink" href="#model.PSBL_PhotAstrom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSBL" title="model.PSBL"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a></p>
<p>Contains methods for model a PSPL photometry + astrometry.
This is a Data-type class in our hierarchy. It is abstract and should not
be instantiated.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom.animate" title="model.PSBL_PhotAstrom.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom.get_all_arrays" title="model.PSBL_PhotAstrom.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom.get_amp_arr" title="model.PSBL_PhotAstrom.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id13"><span class="problematic" id="id14">|J|</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom.get_astrometry" title="model.PSBL_PhotAstrom.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom.get_astrometry_unlensed" title="model.PSBL_PhotAstrom.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom.get_complex_pos" title="model.PSBL_PhotAstrom.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom.get_image_pos_arr" title="model.PSBL_PhotAstrom.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom.get_lens_astrometry" title="model.PSBL_PhotAstrom.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom.get_photometry" title="model.PSBL_PhotAstrom.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom.get_resolved_astrometry" title="model.PSBL_PhotAstrom.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom.get_resolved_photometry" title="model.PSBL_PhotAstrom.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_PhotAstrom.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id15"><span class="problematic" id="id16">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstromParam1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstromParam1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mL1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mL2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muL_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muL_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstromParam1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>Point source binary lens.
It has 3 more parameters than PSPL (additional mass term, separation,
and angle of approach). Note that this is a STATIC binary lens, i.e.
there is no orbital motion.</p>
</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstromParam2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstromParam2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thetaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstromParam2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>Point source binary lens.
It has 3 more parameters than PSPL (additional mass term, separation,
and angle of approach). Note that this is a STATIC binary lens, i.e.
there is no orbital motion.</p>
</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstromParam3">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstromParam3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0_prim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp_prim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thetaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstromParam3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>Point source binary lens.
It has 3 more parameters than PSPL (additional mass term, separation,
and angle of approach). Note that this is a STATIC binary lens, i.e.
there is no orbital motion.</p>
</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstromParam4">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstromParam4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0_com</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp_com</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thetaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstromParam4" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>Point source binary lens.
It has 3 more parameters than PSPL (additional mass term, separation,
and angle of approach). Note that this is a STATIC binary lens, i.e.
there is no orbital motion.</p>
</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotParam1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotParam1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotParam1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>Point source binary lens, photometry only.</p>
<dl class="simple">
<dt>It has 3 more parameters than PSPL_PhotParam1:</dt><dd><p>mass ratio
separation – in units of thetaE
angle of approach</p>
</dd>
</dl>
<p>Note that this is a STATIC binary lens, i.e. there is no orbital motion.</p>
</dd></dl>

<dl class="py class">
<dt id="model.PSBL_GP_PhotParam1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_GP_PhotParam1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_S0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_GP_PhotParam1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSBL_PhotParam1" title="model.PSBL_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotParam1</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="model.PSBL_GP_PhotAstromParam1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_GP_PhotAstromParam1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mL1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mL2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muL_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muL_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_S0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_GP_PhotAstromParam1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSBL_PhotAstromParam1" title="model.PSBL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam1</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="model.PSBL_GP_PhotAstromParam2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_GP_PhotAstromParam2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u0_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thetaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">piE_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_S0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gp_log_omega0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_GP_PhotAstromParam2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSBL_PhotAstromParam2" title="model.PSBL_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam2</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="model.FSPL_PhotAstromParam1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">FSPL_PhotAstromParam1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muL_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muL_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS_N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_sff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstromParam1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
<p>PSPL model for astrometry and photometry - physical parameterization.</p>
<p>A Point Source Point Lens model for microlensing. This model uses a 
parameterization that depends on only physical quantities such as the 
lens mass and positions and proper motions of both the lens and source.</p>
<p>Note the attributes, RA (raL) and Dec (decL) are required 
if you are calculating a model with parallax.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mL: float</strong></dt><dd><p>Mass of the lens (Msun)</p>
</dd>
<dt><strong>t0: float</strong></dt><dd><p>Time of photometric peak, as seen from Earth (MJD.DDD)</p>
</dd>
<dt><strong>beta: float</strong></dt><dd><p>Angular distance between the lens and source on the plane of the sky (mas). Can be
positive (u0_amp &gt; 0 when u0_hat[0] (East component) &lt; 0) or 
negative (u0_amp &lt; 0 when u0_hat[0] (East component) &gt; 0).</p>
</dd>
<dt><strong>dL: float</strong></dt><dd><p>Distance from the observer to the lens (pc)</p>
</dd>
<dt><strong>dL_dS: float</strong></dt><dd><p>Ratio of Distance from the obersver to the lens to
Distance from the observer to the source</p>
</dd>
<dt><strong>xS0_E: float</strong></dt><dd><p>RA Source position on sky at t = t0 (arcsec) in an arbitrary ref. frame.</p>
</dd>
<dt><strong>xS0_N: float</strong></dt><dd><p>Dec source position on sky at t = t0 (arcsec) in an arbitrary ref. frame.</p>
</dd>
<dt><strong>muL_E: float</strong></dt><dd><p>RA Lens proper motion (mas/yr)</p>
</dd>
<dt><strong>muL_N: float</strong></dt><dd><p>Dec Lens proper motion (mas/yr)</p>
</dd>
<dt><strong>muS_E: float</strong></dt><dd><p>RA Source proper motion (mas/yr)</p>
</dd>
<dt><strong>muS_N: float</strong></dt><dd><p>Dec Source proper motion (mas/yr)</p>
</dd>
<dt><strong>radius: float</strong></dt><dd><p>Projected radius of the star in arcsec on the sky plane.</p>
</dd>
<dt><strong>b_sff: float</strong></dt><dd><p>The ratio of the source flux to the total (source + neighbors + lens)
b_sff = f_S / (f_S + f_L + f_N). This must be passed in as a list or
array, with one entry for each photometric filter.</p>
</dd>
<dt><strong>mag_src: float</strong></dt><dd><p>Photometric magnitude of the source. This must be passed in as a
list or array, with one entry for each photometric filter.</p>
</dd>
<dt><strong>n_outline: int</strong></dt><dd><p>Number of boundary points to use when approximating the source outline.
Calculation time scales approximately linearly with ‘n_outline’.</p>
</dd>
<dt><strong>raL: float, optional</strong></dt><dd><p>Right ascension of the lens in decimal degrees.</p>
</dd>
<dt><strong>decL: float, optional</strong></dt><dd><p>Declination of the lens in decimal degrees.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="model.FSPL_PhotAstrom">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">FSPL_PhotAstrom</span></code><a class="headerlink" href="#model.FSPL_PhotAstrom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.FSPL.html#model.FSPL" title="model.FSPL"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.FSPL</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a></p>
<p>Contains methods for model a PSPL photometry + astrometry.
This is a Data-type class in our hierarchy. It is abstract and should not
be instantiated.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.FSPL_PhotAstrom.animate" title="model.FSPL_PhotAstrom.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.FSPL_PhotAstrom.get_astrometry_unlensed" title="model.FSPL_PhotAstrom.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t)</p></td>
<td><p>Input a list of times and it will output the position of the source had it not been lensed at each of the times in the list</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/model.FSPL_PhotAstrom.html#model.FSPL_PhotAstrom.get_lens_astrometry" title="model.FSPL_PhotAstrom.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.FSPL_PhotAstrom.get_source_outline_astrometry" title="model.FSPL_PhotAstrom.get_source_outline_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_source_outline_astrometry</span></code></a>(r, n, center)</p></td>
<td><p>Return astrometric points that outline the outer circumference of the source star.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.FSPL_PhotAstrom.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstrom.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.FSPL_PhotAstrom.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstrom.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Input a list of times and it will output the position of the source had it not been lensed at each of the
times in the list</p>
<p>e.g if n = 4, and say v = [1,0] &amp; the times are [0,1,2] in years.
This will return
((( (1,0),(0,1),(-1,0),(0,-1) ), ( (2,0),(1,1),(0,0),(1,-1) ), ( (3,0),(2,1),(1,0),(2,-1) ))…
=       positions at t=0              positions at t=1                positions at t=2</p>
<p>so np.array(positions) is an array which contains an array for each time step with the positions of all the
points on the boundary of the source.</p>
</dd></dl>

<dl class="py method">
<dt id="model.FSPL_PhotAstrom.get_source_outline_astrometry">
<code class="sig-name descname"><span class="pre">get_source_outline_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstrom.get_source_outline_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Return astrometric points that outline the outer circumference of the
source star. The outline is described as a circle of radius
self.radius and is evaluated at self.n_outline number of points.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.FSPL_Limb_PhotAstromParam1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">FSPL_Limb_PhotAstromParam1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lens_mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xS0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utilde</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_src</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_Limb_PhotAstromParam1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#module-model.PSPL_Param" title="model.PSPL_Param"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Param</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_noPar_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_noPar_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_noParallax.html#model.PSPL_noParallax" title="model.PSPL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstromParam1" title="model.PSPL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param1.animate" title="model.PSPL_PhotAstrom_noPar_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param1.get_amplification" title="model.PSPL_PhotAstrom_noPar_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param1.get_astrometry" title="model.PSPL_PhotAstrom_noPar_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>noParallax: Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param1.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_noPar_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>noParallax: Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param1.get_centroid_shift" title="model.PSPL_PhotAstrom_noPar_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t)</p></td>
<td><p>noParallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param1.get_lens_astrometry" title="model.PSPL_PhotAstrom_noPar_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param1.get_resolved_amplification" title="model.PSPL_PhotAstrom_noPar_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param1.get_resolved_astrometry" title="model.PSPL_PhotAstrom_noPar_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Position of the observed source position in arcsec.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param1.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param1.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param1.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param1.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param1.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param1.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image in arcsec
xS_minus is the vector position of the plus image in arcsec</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_Par_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_Par_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstromParam1" title="model.PSPL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param1.animate" title="model.PSPL_PhotAstrom_Par_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param1.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_Par_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param1.get_amplification" title="model.PSPL_PhotAstrom_Par_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param1.get_astrometry" title="model.PSPL_PhotAstrom_Par_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param1.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_Par_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param1.get_centroid_shift" title="model.PSPL_PhotAstrom_Par_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param1.get_lens_astrometry" title="model.PSPL_PhotAstrom_Par_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param1.get_resolved_amplification" title="model.PSPL_PhotAstrom_Par_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param1.get_resolved_astrometry" title="model.PSPL_PhotAstrom_Par_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param1.get_resolved_shift" title="model.PSPL_PhotAstrom_Par_Param1.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param1.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param1.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param1.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param1.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param1.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param1.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param1.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param1.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param1.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param1.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_LumLens_Par_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax_LumLens.html#model.PSPL_Parallax_LumLens" title="model.PSPL_Parallax_LumLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax_LumLens</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstromParam1" title="model.PSPL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.animate" title="model.PSPL_PhotAstrom_LumLens_Par_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_LumLens_Par_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_amplification" title="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_astrometry" title="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_centroid_shift" title="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_lens_astrometry" title="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_resolved_amplification" title="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_resolved_astrometry" title="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_resolved_shift" title="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param1.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param1.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param1.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_LumLens_Par_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax_LumLens.html#model.PSPL_Parallax_LumLens" title="model.PSPL_Parallax_LumLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax_LumLens</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstromParam2" title="model.PSPL_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.animate" title="model.PSPL_PhotAstrom_LumLens_Par_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_LumLens_Par_Param2.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_amplification" title="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_astrometry" title="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_centroid_shift" title="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_lens_astrometry" title="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_resolved_amplification" title="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_resolved_astrometry" title="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_resolved_shift" title="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param2.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param2.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param2.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param4">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_LumLens_Par_Param4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax_LumLens.html#model.PSPL_Parallax_LumLens" title="model.PSPL_Parallax_LumLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax_LumLens</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstromParam4" title="model.PSPL_PhotAstromParam4"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam4</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.animate" title="model.PSPL_PhotAstrom_LumLens_Par_Param4.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_LumLens_Par_Param4.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_amplification" title="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_astrometry" title="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_centroid_shift" title="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_lens_astrometry" title="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_resolved_amplification" title="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_resolved_astrometry" title="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_resolved_shift" title="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param4.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param4.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_LumLens_Par_Param4.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_LumLens_Par_Param4.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_Par_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_Par_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstromParam2" title="model.PSPL_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param2.animate" title="model.PSPL_PhotAstrom_Par_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param2.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_Par_Param2.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param2.get_amplification" title="model.PSPL_PhotAstrom_Par_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param2.get_astrometry" title="model.PSPL_PhotAstrom_Par_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param2.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_Par_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param2.get_centroid_shift" title="model.PSPL_PhotAstrom_Par_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param2.get_lens_astrometry" title="model.PSPL_PhotAstrom_Par_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param2.get_resolved_amplification" title="model.PSPL_PhotAstrom_Par_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param2.get_resolved_astrometry" title="model.PSPL_PhotAstrom_Par_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param2.get_resolved_shift" title="model.PSPL_PhotAstrom_Par_Param2.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param2.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param2.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param2.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param2.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param2.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param2.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param2.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param2.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param2.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param2.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param2.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param2.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param2.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param2.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param2.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param2.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_noPar_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_noPar_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_noParallax.html#model.PSPL_noParallax" title="model.PSPL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstromParam2" title="model.PSPL_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param2.animate" title="model.PSPL_PhotAstrom_noPar_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param2.get_amplification" title="model.PSPL_PhotAstrom_noPar_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param2.get_astrometry" title="model.PSPL_PhotAstrom_noPar_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>noParallax: Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param2.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_noPar_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>noParallax: Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param2.get_centroid_shift" title="model.PSPL_PhotAstrom_noPar_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t)</p></td>
<td><p>noParallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param2.get_lens_astrometry" title="model.PSPL_PhotAstrom_noPar_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param2.get_resolved_amplification" title="model.PSPL_PhotAstrom_noPar_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param2.get_resolved_astrometry" title="model.PSPL_PhotAstrom_noPar_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param2.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param2.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Position of the observed source position in arcsec.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param2.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param2.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param2.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param2.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param2.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param2.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param2.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param2.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param2.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param2.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image in arcsec
xS_minus is the vector position of the plus image in arcsec</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_Par_Param3">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_Par_Param3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstromParam3" title="model.PSPL_PhotAstromParam3"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam3</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param3.animate" title="model.PSPL_PhotAstrom_Par_Param3.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param3.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_Par_Param3.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param3.get_amplification" title="model.PSPL_PhotAstrom_Par_Param3.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param3.get_astrometry" title="model.PSPL_PhotAstrom_Par_Param3.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param3.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_Par_Param3.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param3.get_centroid_shift" title="model.PSPL_PhotAstrom_Par_Param3.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param3.get_lens_astrometry" title="model.PSPL_PhotAstrom_Par_Param3.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param3.get_resolved_amplification" title="model.PSPL_PhotAstrom_Par_Param3.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param3.get_resolved_astrometry" title="model.PSPL_PhotAstrom_Par_Param3.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param3.get_resolved_shift" title="model.PSPL_PhotAstrom_Par_Param3.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param3.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param3.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param3.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param3.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param3.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param3.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param3.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param3.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param3.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param3.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param3.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param3.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param3.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param3.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param3.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param3.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param3.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param3.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param3.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param3.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_Par_Param4">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_Par_Param4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param4" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstromParam4" title="model.PSPL_PhotAstromParam4"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam4</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param4.animate" title="model.PSPL_PhotAstrom_Par_Param4.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param4.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_Par_Param4.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param4.get_amplification" title="model.PSPL_PhotAstrom_Par_Param4.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param4.get_astrometry" title="model.PSPL_PhotAstrom_Par_Param4.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param4.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_Par_Param4.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param4.get_centroid_shift" title="model.PSPL_PhotAstrom_Par_Param4.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param4.get_lens_astrometry" title="model.PSPL_PhotAstrom_Par_Param4.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param4.get_resolved_amplification" title="model.PSPL_PhotAstrom_Par_Param4.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param4.get_resolved_astrometry" title="model.PSPL_PhotAstrom_Par_Param4.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_Param4.get_resolved_shift" title="model.PSPL_PhotAstrom_Par_Param4.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param4.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param4.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param4.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param4.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param4.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param4.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param4.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param4.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param4.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param4.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param4.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param4.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param4.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param4.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param4.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param4.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param4.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param4.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_Param4.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_Param4.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_noPar_Param4">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_noPar_Param4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param4" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_noParallax.html#model.PSPL_noParallax" title="model.PSPL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstromParam4" title="model.PSPL_PhotAstromParam4"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstromParam4</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param4.animate" title="model.PSPL_PhotAstrom_noPar_Param4.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param4.get_amplification" title="model.PSPL_PhotAstrom_noPar_Param4.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param4.get_astrometry" title="model.PSPL_PhotAstrom_noPar_Param4.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>noParallax: Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param4.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_noPar_Param4.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>noParallax: Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param4.get_centroid_shift" title="model.PSPL_PhotAstrom_noPar_Param4.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t)</p></td>
<td><p>noParallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param4.get_lens_astrometry" title="model.PSPL_PhotAstrom_noPar_Param4.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param4.get_resolved_amplification" title="model.PSPL_PhotAstrom_noPar_Param4.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_Param4.get_resolved_astrometry" title="model.PSPL_PhotAstrom_noPar_Param4.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param4.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param4.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param4.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param4.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param4.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param4.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Position of the observed source position in arcsec.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param4.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param4.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param4.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param4.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param4.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param4.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param4.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param4.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_Param4.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_Param4.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image in arcsec
xS_minus is the vector position of the plus image in arcsec</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Astrom_Par_Param4">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Astrom_Par_Param4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param4" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_Astrom" title="model.PSPL_Astrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Astrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_AstromParam4" title="model.PSPL_AstromParam4"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_AstromParam4</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param4.animate" title="model.PSPL_Astrom_Par_Param4.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param4.calc_piE_ecliptic" title="model.PSPL_Astrom_Par_Param4.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param4.get_amplification" title="model.PSPL_Astrom_Par_Param4.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param4.get_astrometry" title="model.PSPL_Astrom_Par_Param4.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param4.get_astrometry_unlensed" title="model.PSPL_Astrom_Par_Param4.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param4.get_centroid_shift" title="model.PSPL_Astrom_Par_Param4.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param4.get_lens_astrometry" title="model.PSPL_Astrom_Par_Param4.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param4.get_resolved_amplification" title="model.PSPL_Astrom_Par_Param4.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param4.get_resolved_astrometry" title="model.PSPL_Astrom_Par_Param4.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param4.get_resolved_shift" title="model.PSPL_Astrom_Par_Param4.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param4.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param4.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param4.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param4.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param4.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param4.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param4.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param4.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param4.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param4.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param4.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param4.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param4.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param4.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param4.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param4.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param4.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param4.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param4.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param4.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Astrom_Par_Param3">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Astrom_Par_Param3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_Astrom" title="model.PSPL_Astrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Astrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_AstromParam3" title="model.PSPL_AstromParam3"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_AstromParam3</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param3.animate" title="model.PSPL_Astrom_Par_Param3.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param3.calc_piE_ecliptic" title="model.PSPL_Astrom_Par_Param3.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param3.get_amplification" title="model.PSPL_Astrom_Par_Param3.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param3.get_astrometry" title="model.PSPL_Astrom_Par_Param3.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param3.get_astrometry_unlensed" title="model.PSPL_Astrom_Par_Param3.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param3.get_centroid_shift" title="model.PSPL_Astrom_Par_Param3.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param3.get_lens_astrometry" title="model.PSPL_Astrom_Par_Param3.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param3.get_resolved_amplification" title="model.PSPL_Astrom_Par_Param3.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param3.get_resolved_astrometry" title="model.PSPL_Astrom_Par_Param3.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Astrom_Par_Param3.get_resolved_shift" title="model.PSPL_Astrom_Par_Param3.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param3.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param3.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param3.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param3.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param3.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param3.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param3.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param3.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param3.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param3.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param3.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param3.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param3.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param3.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param3.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param3.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param3.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param3.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Astrom_Par_Param3.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Astrom_Par_Param3.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Phot_noPar_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Phot_noPar_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_Phot" title="model.PSPL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSPL_noParallax.html#model.PSPL_noParallax" title="model.PSPL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotParam1" title="model.PSPL_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_Param1.animate" title="model.PSPL_Phot_noPar_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_Param1.get_amplification" title="model.PSPL_Phot_noPar_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_astrometry_unlensed</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Phot_noPar_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_noPar_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Phot_noPar_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Phot_noPar_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_Phot" title="model.PSPL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSPL_noParallax.html#model.PSPL_noParallax" title="model.PSPL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotParam2" title="model.PSPL_PhotParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_Param2.animate" title="model.PSPL_Phot_noPar_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_Param2.get_amplification" title="model.PSPL_Phot_noPar_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_astrometry_unlensed</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Phot_noPar_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_noPar_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Phot_Par_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Phot_Par_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_Phot" title="model.PSPL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotParam1" title="model.PSPL_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_Param1.animate" title="model.PSPL_Phot_Par_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_Param1.calc_piE_ecliptic" title="model.PSPL_Phot_Par_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_Param1.get_amplification" title="model.PSPL_Phot_Par_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_astrometry_unlensed</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Phot_Par_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_Param1.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_Param1.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Phot_Parold_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Phot_Parold_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Parold_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_Phot" title="model.PSPL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax_old.html#model.PSPL_Parallax_old" title="model.PSPL_Parallax_old"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax_old</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotParam2" title="model.PSPL_PhotParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Parold_Param2.animate" title="model.PSPL_Phot_Parold_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Parold_Param2.calc_piE_ecliptic" title="model.PSPL_Phot_Parold_Param2.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Parold_Param2.get_amplification" title="model.PSPL_Phot_Parold_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_astrometry_unlensed</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Phot_Parold_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Parold_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Parold_Param2.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Parold_Param2.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Parold_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Parold_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Phot_Par_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Phot_Par_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_Phot" title="model.PSPL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotParam2" title="model.PSPL_PhotParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_Param2.animate" title="model.PSPL_Phot_Par_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_Param2.calc_piE_ecliptic" title="model.PSPL_Phot_Par_Param2.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_Param2.get_amplification" title="model.PSPL_Phot_Par_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_astrometry_unlensed</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Phot_Par_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_Param2.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_Param2.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Phot_Par_GP_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Phot_Par_GP_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_Phot" title="model.PSPL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotParam1" title="model.PSPL_GP_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param1.animate" title="model.PSPL_Phot_Par_GP_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param1.calc_piE_ecliptic" title="model.PSPL_Phot_Par_GP_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param1.get_amplification" title="model.PSPL_Phot_Par_GP_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param1.get_log_det_covariance" title="model.PSPL_Phot_Par_GP_Param1.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param1.get_photometry_with_gp" title="model.PSPL_Phot_Par_GP_Param1.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param1.log_likely_photometry" title="model.PSPL_Phot_Par_GP_Param1.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_astrometry_unlensed</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param1.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param1.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param1.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param1.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Phot_Par_GP_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Phot_Par_GP_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_Phot" title="model.PSPL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotParam2" title="model.PSPL_GP_PhotParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param2.animate" title="model.PSPL_Phot_Par_GP_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param2.calc_piE_ecliptic" title="model.PSPL_Phot_Par_GP_Param2.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param2.get_amplification" title="model.PSPL_Phot_Par_GP_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param2.get_log_det_covariance" title="model.PSPL_Phot_Par_GP_Param2.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param2.get_photometry_with_gp" title="model.PSPL_Phot_Par_GP_Param2.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param2.log_likely_photometry" title="model.PSPL_Phot_Par_GP_Param2.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_astrometry_unlensed</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param2.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param2.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param2.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param2.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Phot_Par_GP_Param1_2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Phot_Par_GP_Param1_2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_Phot" title="model.PSPL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotParam1_2" title="model.PSPL_GP_PhotParam1_2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotParam1_2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param1_2.animate" title="model.PSPL_Phot_Par_GP_Param1_2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param1_2.calc_piE_ecliptic" title="model.PSPL_Phot_Par_GP_Param1_2.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param1_2.get_amplification" title="model.PSPL_Phot_Par_GP_Param1_2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param1_2.get_log_det_covariance" title="model.PSPL_Phot_Par_GP_Param1_2.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param1_2.get_photometry_with_gp" title="model.PSPL_Phot_Par_GP_Param1_2.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param1_2.log_likely_photometry" title="model.PSPL_Phot_Par_GP_Param1_2.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_astrometry_unlensed</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param1_2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1_2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param1_2.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1_2.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param1_2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1_2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param1_2.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1_2.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param1_2.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1_2.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param1_2.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param1_2.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Phot_Par_GP_Param2_2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Phot_Par_GP_Param2_2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_Phot" title="model.PSPL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotParam2_2" title="model.PSPL_GP_PhotParam2_2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotParam2_2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param2_2.animate" title="model.PSPL_Phot_Par_GP_Param2_2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param2_2.calc_piE_ecliptic" title="model.PSPL_Phot_Par_GP_Param2_2.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param2_2.get_amplification" title="model.PSPL_Phot_Par_GP_Param2_2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param2_2.get_log_det_covariance" title="model.PSPL_Phot_Par_GP_Param2_2.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param2_2.get_photometry_with_gp" title="model.PSPL_Phot_Par_GP_Param2_2.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_Par_GP_Param2_2.log_likely_photometry" title="model.PSPL_Phot_Par_GP_Param2_2.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_astrometry_unlensed</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param2_2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2_2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param2_2.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2_2.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param2_2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2_2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param2_2.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2_2.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param2_2.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2_2.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_Par_GP_Param2_2.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_Par_GP_Param2_2.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Phot_noPar_GP_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Phot_noPar_GP_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_GP_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_Phot" title="model.PSPL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSPL_noParallax.html#model.PSPL_noParallax" title="model.PSPL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotParam1" title="model.PSPL_GP_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_GP_Param1.animate" title="model.PSPL_Phot_noPar_GP_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_GP_Param1.get_amplification" title="model.PSPL_Phot_noPar_GP_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_GP_Param1.get_log_det_covariance" title="model.PSPL_Phot_noPar_GP_Param1.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_GP_Param1.get_photometry_with_gp" title="model.PSPL_Phot_noPar_GP_Param1.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_GP_Param1.log_likely_photometry" title="model.PSPL_Phot_noPar_GP_Param1.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_astrometry_unlensed</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Phot_noPar_GP_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_GP_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_noPar_GP_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_GP_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_noPar_GP_Param1.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_GP_Param1.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_noPar_GP_Param1.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_GP_Param1.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_noPar_GP_Param1.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_GP_Param1.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_Phot_noPar_GP_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_Phot_noPar_GP_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_GP_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_Phot" title="model.PSPL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSPL_noParallax.html#model.PSPL_noParallax" title="model.PSPL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotParam2" title="model.PSPL_GP_PhotParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_GP_Param2.animate" title="model.PSPL_Phot_noPar_GP_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_GP_Param2.get_amplification" title="model.PSPL_Phot_noPar_GP_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_GP_Param2.get_log_det_covariance" title="model.PSPL_Phot_noPar_GP_Param2.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_GP_Param2.get_photometry_with_gp" title="model.PSPL_Phot_noPar_GP_Param2.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_Phot_noPar_GP_Param2.log_likely_photometry" title="model.PSPL_Phot_noPar_GP_Param2.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_astrometry_unlensed</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_Phot_noPar_GP_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_GP_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_noPar_GP_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_GP_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_noPar_GP_Param2.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_GP_Param2.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_noPar_GP_Param2.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_GP_Param2.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_Phot_noPar_GP_Param2.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_Phot_noPar_GP_Param2.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_Par_GP_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotAstromParam1" title="model.PSPL_GP_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param1.animate" title="model.PSPL_PhotAstrom_Par_GP_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param1.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_Par_GP_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_amplification" title="model.PSPL_PhotAstrom_Par_GP_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_astrometry" title="model.PSPL_PhotAstrom_Par_GP_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_Par_GP_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_centroid_shift" title="model.PSPL_PhotAstrom_Par_GP_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_lens_astrometry" title="model.PSPL_PhotAstrom_Par_GP_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_log_det_covariance" title="model.PSPL_PhotAstrom_Par_GP_Param1.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_photometry_with_gp" title="model.PSPL_PhotAstrom_Par_GP_Param1.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_resolved_amplification" title="model.PSPL_PhotAstrom_Par_GP_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_resolved_astrometry" title="model.PSPL_PhotAstrom_Par_GP_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_resolved_shift" title="model.PSPL_PhotAstrom_Par_GP_Param1.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param1.log_likely_photometry" title="model.PSPL_PhotAstrom_Par_GP_Param1.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param1.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param1.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_Par_GP_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotAstromParam2" title="model.PSPL_GP_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param2.animate" title="model.PSPL_PhotAstrom_Par_GP_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param2.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_Par_GP_Param2.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_amplification" title="model.PSPL_PhotAstrom_Par_GP_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_astrometry" title="model.PSPL_PhotAstrom_Par_GP_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_Par_GP_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_centroid_shift" title="model.PSPL_PhotAstrom_Par_GP_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_lens_astrometry" title="model.PSPL_PhotAstrom_Par_GP_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_log_det_covariance" title="model.PSPL_PhotAstrom_Par_GP_Param2.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_photometry_with_gp" title="model.PSPL_PhotAstrom_Par_GP_Param2.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_resolved_amplification" title="model.PSPL_PhotAstrom_Par_GP_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_resolved_astrometry" title="model.PSPL_PhotAstrom_Par_GP_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_resolved_shift" title="model.PSPL_PhotAstrom_Par_GP_Param2.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param2.log_likely_photometry" title="model.PSPL_PhotAstrom_Par_GP_Param2.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param2.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param2.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_Par_GP_Param3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotAstromParam3" title="model.PSPL_GP_PhotAstromParam3"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotAstromParam3</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param3.animate" title="model.PSPL_PhotAstrom_Par_GP_Param3.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param3.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_Par_GP_Param3.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_amplification" title="model.PSPL_PhotAstrom_Par_GP_Param3.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_astrometry" title="model.PSPL_PhotAstrom_Par_GP_Param3.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_Par_GP_Param3.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_centroid_shift" title="model.PSPL_PhotAstrom_Par_GP_Param3.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_lens_astrometry" title="model.PSPL_PhotAstrom_Par_GP_Param3.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_log_det_covariance" title="model.PSPL_PhotAstrom_Par_GP_Param3.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_photometry_with_gp" title="model.PSPL_PhotAstrom_Par_GP_Param3.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_resolved_amplification" title="model.PSPL_PhotAstrom_Par_GP_Param3.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_resolved_astrometry" title="model.PSPL_PhotAstrom_Par_GP_Param3.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_resolved_shift" title="model.PSPL_PhotAstrom_Par_GP_Param3.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param3.log_likely_photometry" title="model.PSPL_PhotAstrom_Par_GP_Param3.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param3.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param3.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_Par_GP_Param4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax.html#model.PSPL_Parallax" title="model.PSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotAstromParam4" title="model.PSPL_GP_PhotAstromParam4"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotAstromParam4</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param4.animate" title="model.PSPL_PhotAstrom_Par_GP_Param4.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param4.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_Par_GP_Param4.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_amplification" title="model.PSPL_PhotAstrom_Par_GP_Param4.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_astrometry" title="model.PSPL_PhotAstrom_Par_GP_Param4.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_Par_GP_Param4.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_centroid_shift" title="model.PSPL_PhotAstrom_Par_GP_Param4.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_lens_astrometry" title="model.PSPL_PhotAstrom_Par_GP_Param4.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_log_det_covariance" title="model.PSPL_PhotAstrom_Par_GP_Param4.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_photometry_with_gp" title="model.PSPL_PhotAstrom_Par_GP_Param4.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_resolved_amplification" title="model.PSPL_PhotAstrom_Par_GP_Param4.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_resolved_astrometry" title="model.PSPL_PhotAstrom_Par_GP_Param4.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_resolved_shift" title="model.PSPL_PhotAstrom_Par_GP_Param4.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_GP_Param4.log_likely_photometry" title="model.PSPL_PhotAstrom_Par_GP_Param4.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_GP_Param4.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_GP_Param4.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_Par_LumLens_GP_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax_LumLens.html#model.PSPL_Parallax_LumLens" title="model.PSPL_Parallax_LumLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax_LumLens</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotAstromParam1" title="model.PSPL_GP_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.animate" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_amplification" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_astrometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_centroid_shift" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_lens_astrometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_log_det_covariance" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_photometry_with_gp" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_resolved_amplification" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_resolved_astrometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_resolved_shift" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.log_likely_photometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param1.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_Par_LumLens_GP_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax_LumLens.html#model.PSPL_Parallax_LumLens" title="model.PSPL_Parallax_LumLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax_LumLens</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotAstromParam2" title="model.PSPL_GP_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.animate" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_amplification" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_astrometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_centroid_shift" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_lens_astrometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_log_det_covariance" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_photometry_with_gp" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_resolved_amplification" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_resolved_astrometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_resolved_shift" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.log_likely_photometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param2.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_Par_LumLens_GP_Param3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax_LumLens.html#model.PSPL_Parallax_LumLens" title="model.PSPL_Parallax_LumLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax_LumLens</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotAstromParam3" title="model.PSPL_GP_PhotAstromParam3"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotAstromParam3</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.animate" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_amplification" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_astrometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_centroid_shift" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_lens_astrometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_log_det_covariance" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_photometry_with_gp" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_resolved_amplification" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_resolved_astrometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_resolved_shift" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.log_likely_photometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param3.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_Par_LumLens_GP_Param4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_Parallax_LumLens.html#model.PSPL_Parallax_LumLens" title="model.PSPL_Parallax_LumLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Parallax_LumLens</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotAstromParam4" title="model.PSPL_GP_PhotAstromParam4"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotAstromParam4</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.animate" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.calc_piE_ecliptic" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_amplification" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_astrometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_centroid_shift" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_lens_astrometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_log_det_covariance" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_photometry_with_gp" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_resolved_amplification" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_resolved_astrometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_resolved_shift" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.log_likely_photometry" title="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image.
xS_minus is the vector position of the plus image.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_Par_LumLens_GP_Param4.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_noPar_GP_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_noParallax.html#model.PSPL_noParallax" title="model.PSPL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotAstromParam1" title="model.PSPL_GP_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.animate" title="model.PSPL_PhotAstrom_noPar_GP_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_amplification" title="model.PSPL_PhotAstrom_noPar_GP_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_astrometry" title="model.PSPL_PhotAstrom_noPar_GP_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>noParallax: Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_noPar_GP_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>noParallax: Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_centroid_shift" title="model.PSPL_PhotAstrom_noPar_GP_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t)</p></td>
<td><p>noParallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_lens_astrometry" title="model.PSPL_PhotAstrom_noPar_GP_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_log_det_covariance" title="model.PSPL_PhotAstrom_noPar_GP_Param1.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_photometry_with_gp" title="model.PSPL_PhotAstrom_noPar_GP_Param1.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_resolved_amplification" title="model.PSPL_PhotAstrom_noPar_GP_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_resolved_astrometry" title="model.PSPL_PhotAstrom_noPar_GP_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.log_likely_photometry" title="model.PSPL_PhotAstrom_noPar_GP_Param1.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Position of the observed source position in arcsec.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param1.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param1.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param1.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param1.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param1.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image in arcsec
xS_minus is the vector position of the plus image in arcsec</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param1.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param1.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSPL_PhotAstrom_noPar_GP_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSPL_noParallax.html#model.PSPL_noParallax" title="model.PSPL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSPL_GP_PhotAstromParam2" title="model.PSPL_GP_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.animate" title="model.PSPL_PhotAstrom_noPar_GP_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_amplification" title="model.PSPL_PhotAstrom_noPar_GP_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_astrometry" title="model.PSPL_PhotAstrom_noPar_GP_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>noParallax: Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_astrometry_unlensed" title="model.PSPL_PhotAstrom_noPar_GP_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>noParallax: Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_centroid_shift" title="model.PSPL_PhotAstrom_noPar_GP_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t)</p></td>
<td><p>noParallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_lens_astrometry" title="model.PSPL_PhotAstrom_noPar_GP_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_log_det_covariance" title="model.PSPL_PhotAstrom_noPar_GP_Param2.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_photometry_with_gp" title="model.PSPL_PhotAstrom_noPar_GP_Param2.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_resolved_amplification" title="model.PSPL_PhotAstrom_noPar_GP_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_resolved_astrometry" title="model.PSPL_PhotAstrom_noPar_GP_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Get the x, y astrometry for each of the two source images, which we label plus and minus.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.log_likely_photometry" title="model.PSPL_PhotAstrom_noPar_GP_Param2.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param2.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Position of the observed source position in arcsec.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param2.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param2.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param2.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param2.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param2.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param2.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param2.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the x, y astrometry for each of the two source images,
which we label plus and minus.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>[xS_plus, xS_minus]</strong><span class="classifier">list of numpy arrays</span></dt><dd><p>xS_plus is the vector position of the plus image in arcsec
xS_minus is the vector position of the plus image in arcsec</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSPL_PhotAstrom_noPar_GP_Param2.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSPL_PhotAstrom_noPar_GP_Param2.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstrom_noPar_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstrom_noPar_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_noParallax.html#model.PSBL_noParallax" title="model.PSBL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstromParam1" title="model.PSBL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.animate" title="model.PSBL_PhotAstrom_noPar_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_all_arrays" title="model.PSBL_PhotAstrom_noPar_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_amp_arr" title="model.PSBL_PhotAstrom_noPar_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id17"><span class="problematic" id="id18">|J|</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_amplification" title="model.PSBL_PhotAstrom_noPar_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_astrometry" title="model.PSBL_PhotAstrom_noPar_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_noPar_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_centroid_shift" title="model.PSBL_PhotAstrom_noPar_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t)</p></td>
<td><p>noParallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_complex_pos" title="model.PSBL_PhotAstrom_noPar_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_image_pos_arr" title="model.PSBL_PhotAstrom_noPar_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_photometry" title="model.PSBL_PhotAstrom_noPar_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_amplification" title="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_astrometry" title="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_photometry" title="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id19"><span class="problematic" id="id20">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstrom_Par_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstrom_Par_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstromParam1" title="model.PSBL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.animate" title="model.PSBL_PhotAstrom_Par_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.calc_piE_ecliptic" title="model.PSBL_PhotAstrom_Par_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_all_arrays" title="model.PSBL_PhotAstrom_Par_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_amp_arr" title="model.PSBL_PhotAstrom_Par_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id21"><span class="problematic" id="id22">|J|</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_amplification" title="model.PSBL_PhotAstrom_Par_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_astrometry" title="model.PSBL_PhotAstrom_Par_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_Par_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_centroid_shift" title="model.PSBL_PhotAstrom_Par_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_complex_pos" title="model.PSBL_PhotAstrom_Par_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_image_pos_arr" title="model.PSBL_PhotAstrom_Par_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_photometry" title="model.PSBL_PhotAstrom_Par_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_amplification" title="model.PSBL_PhotAstrom_Par_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_astrometry" title="model.PSBL_PhotAstrom_Par_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_photometry" title="model.PSBL_PhotAstrom_Par_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_shift" title="model.PSBL_PhotAstrom_Par_Param1.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id23"><span class="problematic" id="id24">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param1.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstrom_noPar_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstrom_noPar_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_noParallax.html#model.PSBL_noParallax" title="model.PSBL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstromParam2" title="model.PSBL_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.animate" title="model.PSBL_PhotAstrom_noPar_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_all_arrays" title="model.PSBL_PhotAstrom_noPar_Param2.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_amp_arr" title="model.PSBL_PhotAstrom_noPar_Param2.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id25"><span class="problematic" id="id26">|J|</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_amplification" title="model.PSBL_PhotAstrom_noPar_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_astrometry" title="model.PSBL_PhotAstrom_noPar_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_noPar_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_centroid_shift" title="model.PSBL_PhotAstrom_noPar_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t)</p></td>
<td><p>noParallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_complex_pos" title="model.PSBL_PhotAstrom_noPar_Param2.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_image_pos_arr" title="model.PSBL_PhotAstrom_noPar_Param2.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_photometry" title="model.PSBL_PhotAstrom_noPar_Param2.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_amplification" title="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_astrometry" title="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_photometry" title="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id27"><span class="problematic" id="id28">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstrom_Par_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstrom_Par_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstromParam2" title="model.PSBL_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.animate" title="model.PSBL_PhotAstrom_Par_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.calc_piE_ecliptic" title="model.PSBL_PhotAstrom_Par_Param2.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_all_arrays" title="model.PSBL_PhotAstrom_Par_Param2.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_amp_arr" title="model.PSBL_PhotAstrom_Par_Param2.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id29"><span class="problematic" id="id30">|J|</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_amplification" title="model.PSBL_PhotAstrom_Par_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_astrometry" title="model.PSBL_PhotAstrom_Par_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_Par_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_centroid_shift" title="model.PSBL_PhotAstrom_Par_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_complex_pos" title="model.PSBL_PhotAstrom_Par_Param2.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_image_pos_arr" title="model.PSBL_PhotAstrom_Par_Param2.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_photometry" title="model.PSBL_PhotAstrom_Par_Param2.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_amplification" title="model.PSBL_PhotAstrom_Par_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_astrometry" title="model.PSBL_PhotAstrom_Par_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param2.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_photometry" title="model.PSBL_PhotAstrom_Par_Param2.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_shift" title="model.PSBL_PhotAstrom_Par_Param2.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id31"><span class="problematic" id="id32">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param2.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstrom_Par_Param3">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstrom_Par_Param3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstromParam3" title="model.PSBL_PhotAstromParam3"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam3</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.animate" title="model.PSBL_PhotAstrom_Par_Param3.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.calc_piE_ecliptic" title="model.PSBL_PhotAstrom_Par_Param3.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_all_arrays" title="model.PSBL_PhotAstrom_Par_Param3.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_amp_arr" title="model.PSBL_PhotAstrom_Par_Param3.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id33"><span class="problematic" id="id34">|J|</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_amplification" title="model.PSBL_PhotAstrom_Par_Param3.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_astrometry" title="model.PSBL_PhotAstrom_Par_Param3.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_Par_Param3.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_centroid_shift" title="model.PSBL_PhotAstrom_Par_Param3.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_complex_pos" title="model.PSBL_PhotAstrom_Par_Param3.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_image_pos_arr" title="model.PSBL_PhotAstrom_Par_Param3.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param3.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_photometry" title="model.PSBL_PhotAstrom_Par_Param3.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_amplification" title="model.PSBL_PhotAstrom_Par_Param3.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_astrometry" title="model.PSBL_PhotAstrom_Par_Param3.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param3.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_photometry" title="model.PSBL_PhotAstrom_Par_Param3.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_shift" title="model.PSBL_PhotAstrom_Par_Param3.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id35"><span class="problematic" id="id36">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param3.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstrom_Par_Param4">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstrom_Par_Param4</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstromParam4" title="model.PSBL_PhotAstromParam4"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam4</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.animate" title="model.PSBL_PhotAstrom_Par_Param4.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.calc_piE_ecliptic" title="model.PSBL_PhotAstrom_Par_Param4.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_all_arrays" title="model.PSBL_PhotAstrom_Par_Param4.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_amp_arr" title="model.PSBL_PhotAstrom_Par_Param4.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id37"><span class="problematic" id="id38">|J|</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_amplification" title="model.PSBL_PhotAstrom_Par_Param4.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_astrometry" title="model.PSBL_PhotAstrom_Par_Param4.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_Par_Param4.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_centroid_shift" title="model.PSBL_PhotAstrom_Par_Param4.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_complex_pos" title="model.PSBL_PhotAstrom_Par_Param4.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_image_pos_arr" title="model.PSBL_PhotAstrom_Par_Param4.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param4.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_photometry" title="model.PSBL_PhotAstrom_Par_Param4.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_amplification" title="model.PSBL_PhotAstrom_Par_Param4.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_astrometry" title="model.PSBL_PhotAstrom_Par_Param4.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param4.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_photometry" title="model.PSBL_PhotAstrom_Par_Param4.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_shift" title="model.PSBL_PhotAstrom_Par_Param4.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id39"><span class="problematic" id="id40">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_Param4.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_Phot_noPar_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_Phot_noPar_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSBL_Phot" title="model.PSBL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSBL_noParallax.html#model.PSBL_noParallax" title="model.PSBL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotParam1" title="model.PSBL_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.animate" title="model.PSBL_Phot_noPar_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_all_arrays" title="model.PSBL_Phot_noPar_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_amp_arr" title="model.PSBL_Phot_noPar_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id41"><span class="problematic" id="id42">|J|</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_amplification" title="model.PSBL_Phot_noPar_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_astrometry" title="model.PSBL_Phot_noPar_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in Einstein radii.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_astrometry_unlensed" title="model.PSBL_Phot_noPar_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_complex_pos" title="model.PSBL_Phot_noPar_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_image_pos_arr" title="model.PSBL_Phot_noPar_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_photometry" title="model.PSBL_Phot_noPar_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_resolved_astrometry" title="model.PSBL_Phot_noPar_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in Einstein radii.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_resolved_lens_astrometry" title="model.PSBL_Phot_noPar_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_resolved_photometry" title="model.PSBL_Phot_noPar_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_Phot_noPar_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_Param1.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_Param1.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id43"><span class="problematic" id="id44">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.
Note, this is a photometry only model, so units are in Einstein radii.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_Param1.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_Param1.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_Param1.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_Param1.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.
Note, this is a photometry only model, so units are in Einstein radii.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_Param1.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_Phot_Par_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_Phot_Par_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSBL_Phot" title="model.PSBL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotParam1" title="model.PSBL_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.animate" title="model.PSBL_Phot_Par_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.calc_piE_ecliptic" title="model.PSBL_Phot_Par_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_all_arrays" title="model.PSBL_Phot_Par_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_amp_arr" title="model.PSBL_Phot_Par_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id45"><span class="problematic" id="id46">|J|</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_amplification" title="model.PSBL_Phot_Par_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_astrometry" title="model.PSBL_Phot_Par_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in Einstein radii.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_astrometry_unlensed" title="model.PSBL_Phot_Par_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_complex_pos" title="model.PSBL_Phot_Par_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_image_pos_arr" title="model.PSBL_Phot_Par_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_photometry" title="model.PSBL_Phot_Par_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_resolved_astrometry" title="model.PSBL_Phot_Par_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in Einstein radii.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_resolved_lens_astrometry" title="model.PSBL_Phot_Par_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_resolved_photometry" title="model.PSBL_Phot_Par_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_Phot_Par_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_Param1.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_Param1.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_Param1.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id47"><span class="problematic" id="id48">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.
Note, this is a photometry only model, so units are in Einstein radii.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_Param1.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_Param1.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_Param1.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_Param1.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.
Note, this is a photometry only model, so units are in Einstein radii.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_Param1.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstrom_noPar_GP_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_noParallax.html#model.PSBL_noParallax" title="model.PSBL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstromParam1" title="model.PSBL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.animate" title="model.PSBL_PhotAstrom_noPar_GP_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_all_arrays" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_amp_arr" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id49"><span class="problematic" id="id50">|J|</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_amplification" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_centroid_shift" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t)</p></td>
<td><p>noParallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_complex_pos" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_image_pos_arr" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_log_det_covariance" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry_with_gp" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_amplification" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_photometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.log_likely_photometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id51"><span class="problematic" id="id52">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param1.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstrom_Par_GP_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstromParam1" title="model.PSBL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.animate" title="model.PSBL_PhotAstrom_Par_GP_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.calc_piE_ecliptic" title="model.PSBL_PhotAstrom_Par_GP_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_all_arrays" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_amp_arr" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id53"><span class="problematic" id="id54">|J|</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_amplification" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_centroid_shift" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_complex_pos" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_image_pos_arr" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_lens_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_log_det_covariance" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry_with_gp" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_amplification" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_photometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_shift" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.log_likely_photometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id55"><span class="problematic" id="id56">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param1.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstrom_noPar_GP_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_noParallax.html#model.PSBL_noParallax" title="model.PSBL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstromParam2" title="model.PSBL_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.animate" title="model.PSBL_PhotAstrom_noPar_GP_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_all_arrays" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_amp_arr" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id57"><span class="problematic" id="id58">|J|</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_amplification" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_centroid_shift" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t)</p></td>
<td><p>noParallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_complex_pos" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_image_pos_arr" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_log_det_covariance" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry_with_gp" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_amplification" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_photometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.log_likely_photometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id59"><span class="problematic" id="id60">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_noPar_GP_Param2.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_PhotAstrom_Par_GP_Param2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotAstromParam2" title="model.PSBL_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.animate" title="model.PSBL_PhotAstrom_Par_GP_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.calc_piE_ecliptic" title="model.PSBL_PhotAstrom_Par_GP_Param2.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_all_arrays" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_amp_arr" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id61"><span class="problematic" id="id62">|J|</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_amplification" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_centroid_shift" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_complex_pos" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_image_pos_arr" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_lens_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_log_det_covariance" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry_with_gp" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_amplification" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_photometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_shift" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.log_likely_photometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id63"><span class="problematic" id="id64">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_PhotAstrom_Par_GP_Param2.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_Phot_noPar_GP_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_Phot_noPar_GP_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSBL_Phot" title="model.PSBL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSBL_noParallax.html#model.PSBL_noParallax" title="model.PSBL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_noParallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotParam1" title="model.PSBL_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.animate" title="model.PSBL_Phot_noPar_GP_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_all_arrays" title="model.PSBL_Phot_noPar_GP_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_amp_arr" title="model.PSBL_Phot_noPar_GP_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id65"><span class="problematic" id="id66">|J|</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_amplification" title="model.PSBL_Phot_noPar_GP_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_astrometry" title="model.PSBL_Phot_noPar_GP_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in Einstein radii.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_astrometry_unlensed" title="model.PSBL_Phot_noPar_GP_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_complex_pos" title="model.PSBL_Phot_noPar_GP_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_image_pos_arr" title="model.PSBL_Phot_noPar_GP_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_log_det_covariance" title="model.PSBL_Phot_noPar_GP_Param1.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_photometry" title="model.PSBL_Phot_noPar_GP_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_photometry_with_gp" title="model.PSBL_Phot_noPar_GP_Param1.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_resolved_astrometry" title="model.PSBL_Phot_noPar_GP_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in Einstein radii.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_resolved_lens_astrometry" title="model.PSBL_Phot_noPar_GP_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_resolved_photometry" title="model.PSBL_Phot_noPar_GP_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.log_likely_photometry" title="model.PSBL_Phot_noPar_GP_Param1.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id67"><span class="problematic" id="id68">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.
Note, this is a photometry only model, so units are in Einstein radii.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.
Note, this is a photometry only model, so units are in Einstein radii.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_noPar_GP_Param1.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.PSBL_Phot_Par_GP_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">PSBL_Phot_Par_GP_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="#model.PSBL_Phot" title="model.PSBL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="#model.PSBL_PhotParam1" title="model.PSBL_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.animate" title="model.PSBL_Phot_Par_GP_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.calc_piE_ecliptic" title="model.PSBL_Phot_Par_GP_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_all_arrays" title="model.PSBL_Phot_Par_GP_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs)</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_amp_arr" title="model.PSBL_Phot_Par_GP_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id69"><span class="problematic" id="id70">|J|</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_amplification" title="model.PSBL_Phot_Par_GP_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_astrometry" title="model.PSBL_Phot_Par_GP_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, …])</p></td>
<td><p>Position of the observed (unresolved) source position in Einstein radii.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_astrometry_unlensed" title="model.PSBL_Phot_Par_GP_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn’t exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_complex_pos" title="model.PSBL_Phot_Par_GP_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_image_pos_arr" title="model.PSBL_Phot_Par_GP_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Solve the fifth-order polynomial and get the image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_log_det_covariance" title="model.PSBL_Phot_Par_GP_Param1.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_photometry" title="model.PSBL_Phot_Par_GP_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_photometry_with_gp" title="model.PSBL_Phot_Par_GP_Param1.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, …)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_resolved_astrometry" title="model.PSBL_Phot_Par_GP_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, …])</p></td>
<td><p>Position of the observed source position in Einstein radii.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_resolved_lens_astrometry" title="model.PSBL_Phot_Par_GP_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_resolved_photometry" title="model.PSBL_Phot_Par_GP_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, …])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.log_likely_photometry" title="model.PSBL_Phot_Par_GP_Param1.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, …[, …])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.get_all_arrays">
<code class="sig-name descname"><span class="pre">get_all_arrays</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.get_amp_arr">
<code class="sig-name descname"><span class="pre">get_amp_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the amplification A from the Jacobian J, A = 1/<a href="#id71"><span class="problematic" id="id72">|J|</span></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Complex position of images. Shape = [N_times, N_solutions, 1]
– note this could be jagged.</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.
Note, this is a photometry only model, so units are in Einstein radii.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.get_complex_pos">
<code class="sig-name descname"><span class="pre">get_complex_pos</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors z = (x,y) as z = x + iy.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.get_image_pos_arr">
<code class="sig-name descname"><span class="pre">get_image_pos_arr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the fifth-order polynomial and get the image positions.
See PSBL writeup for full equations.
All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.get_log_det_covariance">
<code class="sig-name descname"><span class="pre">get_log_det_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_log_det_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.get_photometry">
<code class="sig-name descname"><span class="pre">get_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.get_photometry_with_gp">
<code class="sig-name descname"><span class="pre">get_photometry_with_gp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_photometry_with_gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<p>Note: This will throw an error if this is a filter with use_gp_phot[filt_index] = False.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.get_resolved_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.get_resolved_lens_astrometry">
<code class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.
Note, this is a photometry only model, so units are in Einstein radii.</p>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.get_resolved_photometry">
<code class="sig-name descname"><span class="pre">get_resolved_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="model.PSBL_Phot_Par_GP_Param1.log_likely_photometry">
<code class="sig-name descname"><span class="pre">log_likely_photometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.log_likely_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<p>Note: The GP will only be used for filters where use_gp_phot[filt_index] = True.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="model.FSPL_PhotAstrom_Par_Param1">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">FSPL_PhotAstrom_Par_Param1</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstrom_Par_Param1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#model.FSPL_PhotAstrom" title="model.FSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.FSPL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.FSPL_Parallax.html#model.FSPL_Parallax" title="model.FSPL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.FSPL_Parallax</span></code></a>, <a class="reference internal" href="#model.FSPL_PhotAstromParam1" title="model.FSPL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.FSPL_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.FSPL_PhotAstrom_Par_Param1.animate" title="model.FSPL_PhotAstrom_Par_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, …)</p></td>
<td><p>This function takes the PSPL and makes an animation, the input variables are as follows tE = number of einstein crossings times before/after the peak you want the animation to plot      e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE time_steps = number of time steps before/after peak, so total number of time steps will      be 2 times this value frame_time = times in ms of each frame in the animation name = string, the animation will be saved as name.html size = [horizontal, vertical] cm’s zoom = # of einstein radii plotted in vertical direction</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.FSPL_PhotAstrom_Par_Param1.calc_piE_ecliptic" title="model.FSPL_PhotAstrom_Par_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.FSPL_PhotAstrom_Par_Param1.get_amplification" title="model.FSPL_PhotAstrom_Par_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.FSPL_PhotAstrom_Par_Param1.get_astrometry" title="model.FSPL_PhotAstrom_Par_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, ast_filt_idx])</p></td>
<td><p>Parallax: Get astrometry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.FSPL_PhotAstrom_Par_Param1.get_astrometry_unlensed" title="model.FSPL_PhotAstrom_Par_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t)</p></td>
<td><p>Input a list of times and it will output the position of the source had it not been lensed at each of the times in the list</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.FSPL_PhotAstrom_Par_Param1.get_centroid_shift" title="model.FSPL_PhotAstrom_Par_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code>(t_obs)</p></td>
<td><p>Parallax: Get lens astrometry</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.FSPL_PhotAstrom_Par_Param1.get_resolved_amplification" title="model.FSPL_PhotAstrom_Par_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.FSPL_PhotAstrom_Par_Param1.get_resolved_shift" title="model.FSPL_PhotAstrom_Par_Param1.get_resolved_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_shift</span></code></a>(t_obs)</p></td>
<td><p>Parallax: Get resolved shift</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.FSPL_PhotAstrom_Par_Param1.get_source_outline_astrometry" title="model.FSPL_PhotAstrom_Par_Param1.get_source_outline_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_source_outline_astrometry</span></code></a>(r, n, center)</p></td>
<td><p>Return astrometric points that outline the outer circumference of the source star.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="model.FSPL_PhotAstrom_Par_Param1.animate">
<code class="sig-name descname"><span class="pre">animate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstrom_Par_Param1.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes the PSPL and makes an animation, the input variables are as follows
tE = number of einstein crossings times before/after the peak you want the animation to plot</p>
<blockquote>
<div><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</div></blockquote>
<dl class="simple">
<dt>time_steps = number of time steps before/after peak, so total number of time steps will </dt><dd><p>be 2 times this value</p>
</dd>
</dl>
<p>frame_time = times in ms of each frame in the animation
name = string, the animation will be saved as name.html
size = [horizontal, vertical] cm’s
zoom = # of einstein radii plotted in vertical direction</p>
</dd></dl>

<dl class="py method">
<dt id="model.FSPL_PhotAstrom_Par_Param1.calc_piE_ecliptic">
<code class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstrom_Par_Param1.calc_piE_ecliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt id="model.FSPL_PhotAstrom_Par_Param1.get_amplification">
<code class="sig-name descname"><span class="pre">get_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstrom_Par_Param1.get_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t.</p>
</dd></dl>

<dl class="py method">
<dt id="model.FSPL_PhotAstrom_Par_Param1.get_astrometry">
<code class="sig-name descname"><span class="pre">get_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstrom_Par_Param1.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get astrometry</p>
</dd></dl>

<dl class="py method">
<dt id="model.FSPL_PhotAstrom_Par_Param1.get_astrometry_unlensed">
<code class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstrom_Par_Param1.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Input a list of times and it will output the position of the source had it not been lensed at each of the
times in the list</p>
<p>e.g if n = 4, and say v = [1,0] &amp; the times are [0,1,2] in years.
This will return
((( (1,0),(0,1),(-1,0),(0,-1) ), ( (2,0),(1,1),(0,0),(1,-1) ), ( (3,0),(2,1),(1,0),(2,-1) ))…
=       positions at t=0              positions at t=1                positions at t=2</p>
<p>so np.array(positions) is an array which contains an array for each time step with the positions of all the
points on the boundary of the source.</p>
</dd></dl>

<dl class="py method">
<dt id="model.FSPL_PhotAstrom_Par_Param1.get_centroid_shift">
<code class="sig-name descname"><span class="pre">get_centroid_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstrom_Par_Param1.get_centroid_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt id="model.FSPL_PhotAstrom_Par_Param1.get_resolved_amplification">
<code class="sig-name descname"><span class="pre">get_resolved_amplification</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstrom_Par_Param1.get_resolved_amplification" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
</dd></dl>

<dl class="py method">
<dt id="model.FSPL_PhotAstrom_Par_Param1.get_resolved_shift">
<code class="sig-name descname"><span class="pre">get_resolved_shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstrom_Par_Param1.get_resolved_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Parallax: Get resolved shift</p>
</dd></dl>

<dl class="py method">
<dt id="model.FSPL_PhotAstrom_Par_Param1.get_source_outline_astrometry">
<code class="sig-name descname"><span class="pre">get_source_outline_astrometry</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.FSPL_PhotAstrom_Par_Param1.get_source_outline_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Return astrometric points that outline the outer circumference of the
source star. The outline is described as a circle of radius
self.radius and is evaluated at self.n_outline number of points.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="model.u0_hat_from_thetaE_hat">
<code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">u0_hat_from_thetaE_hat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thetaE_hat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.u0_hat_from_thetaE_hat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Calculate the closest approach vector direction. Define the beta sign convention
as Andy Gould does with</p>
<blockquote>
<div><p>beta &gt; 0 means u0_E &gt; 0
u0_amp &gt; 0 mean u0_E &gt; 0</p>
</div></blockquote>
<p>See Gould 2004, pg 320, bottom right
u0 &gt; 0 == lens passes to the right side of the source as seen from Earth</p>
</div></blockquote>
<p>ec{thetaX0} = 
ec{xS0} - 
ec{xL0} = 
ec{u0} * thetaE</p>
<blockquote>
<div><p>which implies that:</p>
<p>u0_E &gt; 0 for u0 &gt; 0
u0_E &lt; 0 for u0 &lt; 0</p>
<p>which is what we use.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="model.dparallax_dt_in_direction">
<code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">dparallax_dt_in_direction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mjd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.dparallax_dt_in_direction" title="Permalink to this definition">¶</a></dt>
<dd><p>R.A. in degrees. (J2000)
Dec. in degrees. (J2000)
MJD</p>
<p>Equations following MulensModel.
Time derivative –&gt; units are yr^-1</p>
</dd></dl>

<dl class="py function">
<dt id="model.parallax_in_direction_old">
<code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">parallax_in_direction_old</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mjd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Res_fix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ephem</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.parallax_in_direction_old" title="Permalink to this definition">¶</a></dt>
<dd><p>R.A. in degrees. (J2000)
Dec. in degrees. (J2000)
MJDOA</p>
<p>Equations implemented from Hog+ 1995.</p>
<p>Sun - Earth</p>
</dd></dl>

<dl class="py function">
<dt id="model.sun_position">
<code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">sun_position</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mjd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radians</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.sun_position" title="Permalink to this definition">¶</a></dt>
<dd><p>;+
; NAME:
;       SUNPOS
; PURPOSE:
;       To compute the RA and Dec of the Sun at a given date.
;
; INPUTS:
;       mjd    - The modified Julian date of the day (and time), scalar or vector
;
; OUTPUTS:
;       ra    - The right ascension of the sun at that date in DEGREES
;               double precision, same number of elements as jd
;       dec   - The declination of the sun at that date in DEGREES
;       elong - Ecliptic longitude of the sun at that date in DEGREES.
;       obliquity - the obliquity of the ecliptic, in DEGREES
;
; OPTIONAL INPUT KEYWORD:
;       RADIAN [def=False] - If this keyword is set to True, then all output variables
;               are given in Radians rather than Degrees
;
; NOTES:
;       Patrick Wallace (Rutherford Appleton Laboratory, UK) has tested the
;       accuracy of a C adaptation of the sunpos.pro code and found the
;       following results.   From 1900-2100 SUNPOS  gave 7.3 arcsec maximum
;       error, 2.6 arcsec RMS.  Over the shorter interval 1950-2050 the figures
;       were 6.4 arcsec max, 2.2 arcsec RMS.
;
;       The returned RA and Dec are in the given date’s equinox.
;
;       Procedure was extensively revised in May 1996, and the new calling
;       sequence is incompatible with the old one.
; METHOD:
;       Uses a truncated version of Newcomb’s Sun.    Adapted from the IDL
;       routine SUN_POS by CD Pike, which was adapted from a FORTRAN routine
;       by B. Emerson (RGO).
; EXAMPLE:
;       (1) Find the apparent RA and Dec of the Sun on May 1, 1982
;
;       IDL&gt; jdcnv, 1982, 5, 1,0 ,jd      ;Find Julian date jd = 2445090.5
;       IDL&gt; sunpos, jd, ra, dec
;       IDL&gt; print,adstring(ra,dec,2)
;                02 31 32.61  +14 54 34.9
;
;       The Astronomical Almanac gives 02 31 32.58 +14 54 34.9 so the error
;               in SUNPOS for this case is &lt; 0.5”.
;
;       (2) Find the apparent RA and Dec of the Sun for every day in 1997
;
;       IDL&gt; jdcnv, 1997,1,1,0, jd                ;Julian date on Jan 1, 1997
;       IDL&gt; sunpos, jd+ dindgen(365), ra, dec    ;RA and Dec for each day
;
; MODIFICATION HISTORY:
;       Written by Michael R. Greason, STX, 28 October 1988.
;       Accept vector arguments, W. Landsman     April,1989
;       Eliminated negative right ascensions.  MRG, Hughes STX, 6 May 1992.
;       Rewritten using the 1993 Almanac.  Keywords added.  MRG, HSTX,
;               10 February 1994.
;       Major rewrite, improved accuracy, always return values in degrees
;       W. Landsman  May, 1996
;       Added /RADIAN keyword,    W. Landsman       August, 1997
;       Converted to IDL V5.0   W. Landsman   September 1997
;       Converted to python     J. R. Lu    August 2016
;-</p>
</dd></dl>

<dl class="py function">
<dt id="model.get_image">
<code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">get_image</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.get_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to find the images of the star given the input parameters:
y0 = position of the cente of the source star, in units of anguler Einstein radius
m1 = Mass of rightmost lens divided by the total mass
d = separation of the lenses in angular Einstein radii
R = angular radius of the source in angular Einstein radii</p>
</dd></dl>

<dl class="py function">
<dt id="model.cluster">
<code class="sig-prename descclassname"><span class="pre">model.</span></code><code class="sig-name descname"><span class="pre">cluster</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Split the image points up into a number of clusters
image = a list of points, all of which are inside some image of the star
R = radius of the star</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-model.PSPL_Param">
<span id="pspl"></span><h2>PSPL<a class="headerlink" href="#module-model.PSPL_Param" title="Permalink to this headline">¶</a></h2>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Niranjan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>