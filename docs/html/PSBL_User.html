<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PSBL User Classes &mdash; BAGLE 0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="FSPL User Class" href="FSPL_User.html" />
    <link rel="prev" title="PSPL User Classes" href="PSPL_User.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> BAGLE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="model3.html">Model.py Overview</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="model3.html#class-families">Class Families</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="model3.html#data-class-family">Data Class Family</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="intro.html">BAGLE TUTORIAL</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="UserClass.html">User Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="PSPL.html">POINT SOURCE POINT LENS (PSPL) CLASSES</a></li>
<li class="toctree-l4"><a class="reference internal" href="PSBL.html">POINT SOURCE BINARY LENS (PSBL) CLASSES</a></li>
<li class="toctree-l4"><a class="reference internal" href="BSPL.html">POINT SOURCE POINT LENS (PSPL) CLASSES</a></li>
<li class="toctree-l4"><a class="reference internal" href="FSPL.html">FSPL(Finite-Source Point Lens) Models - NOT DONE YET… place holders</a></li>
<li class="toctree-l4"><a class="reference internal" href="Gen_Use.html">GENERAL USE AND SHARED FUNCTIONS</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BAGLE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="model3.html">Model.py Overview</a> &raquo;</li>
          <li><a href="UserClass.html">User Classes</a> &raquo;</li>
      <li>PSBL User Classes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/PSBL_User.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="psbl-user-classes">
<h1>PSBL User Classes<a class="headerlink" href="#psbl-user-classes" title="Permalink to this headline"></a></h1>
<div class="section" id="psbl">
<h2>PSBL<a class="headerlink" href="#psbl" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_PhotAstrom_noPar_Param1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_noParallax.html#model.PSBL_noParallax" title="model.PSBL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_noParallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstromParam1.html#model.PSBL_PhotAstromParam1" title="model.PSBL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.animate" title="model.PSBL_PhotAstrom_noPar_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_all_arrays" title="model.PSBL_PhotAstrom_noPar_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_amp_arr" title="model.PSBL_PhotAstrom_noPar_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_amplification" title="model.PSBL_PhotAstrom_noPar_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_astrometry" title="model.PSBL_PhotAstrom_noPar_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_noPar_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_centroid" title="model.PSBL_PhotAstrom_noPar_Param1.get_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid</span></code></a>(t_obs[, ast_filt_idx, ...])</p></td>
<td><p>PSPL: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_centroid_shift" title="model.PSBL_PhotAstrom_noPar_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t)</p></td>
<td><p>noParallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_complex_pos" title="model.PSBL_PhotAstrom_noPar_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_image_pos_arr" title="model.PSBL_PhotAstrom_noPar_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_image_pos_arr_old" title="model.PSBL_PhotAstrom_noPar_Param1.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_photometry" title="model.PSBL_PhotAstrom_noPar_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_amplification" title="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_astrometry" title="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_photometry" title="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param1.rescale_complex_pos" title="model.PSBL_PhotAstrom_noPar_Param1.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, shape = len(t_obs) x 2</span></dt><dd><p>The unlensed positions of the source in arcseconds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_centroid">
<span class="sig-name descname"><span class="pre">get_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_centroid" title="Permalink to this definition"></a></dt>
<dd><p>PSPL: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array or float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Centroid offset on the plane of the sky in milli-arcseoncds.</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ast_filt_idx</strong><span class="classifier">int</span></dt><dd><p>Index into the photometry parameter lists for the photometry that
corresponds to this astrometry data set.</p>
</dd>
<dt><strong>image_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param1.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param1.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_PhotAstrom_noPar_Param2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_noParallax.html#model.PSBL_noParallax" title="model.PSBL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_noParallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstromParam2.html#model.PSBL_PhotAstromParam2" title="model.PSBL_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.animate" title="model.PSBL_PhotAstrom_noPar_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_all_arrays" title="model.PSBL_PhotAstrom_noPar_Param2.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_amp_arr" title="model.PSBL_PhotAstrom_noPar_Param2.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_amplification" title="model.PSBL_PhotAstrom_noPar_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_astrometry" title="model.PSBL_PhotAstrom_noPar_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_noPar_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_centroid" title="model.PSBL_PhotAstrom_noPar_Param2.get_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid</span></code></a>(t_obs[, ast_filt_idx, ...])</p></td>
<td><p>PSPL: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_centroid_shift" title="model.PSBL_PhotAstrom_noPar_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t)</p></td>
<td><p>noParallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_complex_pos" title="model.PSBL_PhotAstrom_noPar_Param2.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_image_pos_arr" title="model.PSBL_PhotAstrom_noPar_Param2.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_image_pos_arr_old" title="model.PSBL_PhotAstrom_noPar_Param2.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_photometry" title="model.PSBL_PhotAstrom_noPar_Param2.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_amplification" title="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_astrometry" title="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_photometry" title="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_Param2.rescale_complex_pos" title="model.PSBL_PhotAstrom_noPar_Param2.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, shape = len(t_obs) x 2</span></dt><dd><p>The unlensed positions of the source in arcseconds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_centroid">
<span class="sig-name descname"><span class="pre">get_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_centroid" title="Permalink to this definition"></a></dt>
<dd><p>PSPL: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array or float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Centroid offset on the plane of the sky in milli-arcseoncds.</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ast_filt_idx</strong><span class="classifier">int</span></dt><dd><p>Index into the photometry parameter lists for the photometry that
corresponds to this astrometry data set.</p>
</dd>
<dt><strong>image_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_Param2.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_Param2.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="psbl-parallax">
<h2>PSBL Parallax<a class="headerlink" href="#psbl-parallax" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_PhotAstrom_Par_Param1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstromParam1.html#model.PSBL_PhotAstromParam1" title="model.PSBL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.animate" title="model.PSBL_PhotAstrom_Par_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.calc_piE_ecliptic" title="model.PSBL_PhotAstrom_Par_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_all_arrays" title="model.PSBL_PhotAstrom_Par_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_amp_arr" title="model.PSBL_PhotAstrom_Par_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_amplification" title="model.PSBL_PhotAstrom_Par_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_astrometry" title="model.PSBL_PhotAstrom_Par_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_Par_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_centroid" title="model.PSBL_PhotAstrom_Par_Param1.get_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid</span></code></a>(t_obs[, ast_filt_idx, ...])</p></td>
<td><p>PSPL: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_centroid_shift" title="model.PSBL_PhotAstrom_Par_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_complex_pos" title="model.PSBL_PhotAstrom_Par_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_image_pos_arr" title="model.PSBL_PhotAstrom_Par_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_image_pos_arr_old" title="model.PSBL_PhotAstrom_Par_Param1.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_photometry" title="model.PSBL_PhotAstrom_Par_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_amplification" title="model.PSBL_PhotAstrom_Par_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_astrometry" title="model.PSBL_PhotAstrom_Par_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_photometry" title="model.PSBL_PhotAstrom_Par_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param1.rescale_complex_pos" title="model.PSBL_PhotAstrom_Par_Param1.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.calc_piE_ecliptic">
<span class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.calc_piE_ecliptic" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, shape = len(t_obs) x 2</span></dt><dd><p>The unlensed positions of the source in arcseconds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_centroid">
<span class="sig-name descname"><span class="pre">get_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_centroid" title="Permalink to this definition"></a></dt>
<dd><p>PSPL: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array or float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Centroid offset on the plane of the sky in milli-arcseoncds.</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ast_filt_idx</strong><span class="classifier">int</span></dt><dd><p>Index into the photometry parameter lists for the photometry that
corresponds to this astrometry data set.</p>
</dd>
<dt><strong>image_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param1.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param1.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_PhotAstrom_Par_Param2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstromParam2.html#model.PSBL_PhotAstromParam2" title="model.PSBL_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.animate" title="model.PSBL_PhotAstrom_Par_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.calc_piE_ecliptic" title="model.PSBL_PhotAstrom_Par_Param2.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_all_arrays" title="model.PSBL_PhotAstrom_Par_Param2.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_amp_arr" title="model.PSBL_PhotAstrom_Par_Param2.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_amplification" title="model.PSBL_PhotAstrom_Par_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_astrometry" title="model.PSBL_PhotAstrom_Par_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_Par_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_centroid" title="model.PSBL_PhotAstrom_Par_Param2.get_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid</span></code></a>(t_obs[, ast_filt_idx, ...])</p></td>
<td><p>PSPL: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_centroid_shift" title="model.PSBL_PhotAstrom_Par_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_complex_pos" title="model.PSBL_PhotAstrom_Par_Param2.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_image_pos_arr" title="model.PSBL_PhotAstrom_Par_Param2.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_image_pos_arr_old" title="model.PSBL_PhotAstrom_Par_Param2.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_photometry" title="model.PSBL_PhotAstrom_Par_Param2.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_amplification" title="model.PSBL_PhotAstrom_Par_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_astrometry" title="model.PSBL_PhotAstrom_Par_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param2.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_photometry" title="model.PSBL_PhotAstrom_Par_Param2.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param2.rescale_complex_pos" title="model.PSBL_PhotAstrom_Par_Param2.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.calc_piE_ecliptic">
<span class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.calc_piE_ecliptic" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, shape = len(t_obs) x 2</span></dt><dd><p>The unlensed positions of the source in arcseconds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_centroid">
<span class="sig-name descname"><span class="pre">get_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_centroid" title="Permalink to this definition"></a></dt>
<dd><p>PSPL: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array or float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Centroid offset on the plane of the sky in milli-arcseoncds.</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ast_filt_idx</strong><span class="classifier">int</span></dt><dd><p>Index into the photometry parameter lists for the photometry that
corresponds to this astrometry data set.</p>
</dd>
<dt><strong>image_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param2.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param2.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_PhotAstrom_Par_Param3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstromParam3.html#model.PSBL_PhotAstromParam3" title="model.PSBL_PhotAstromParam3"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam3</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.animate" title="model.PSBL_PhotAstrom_Par_Param3.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.calc_piE_ecliptic" title="model.PSBL_PhotAstrom_Par_Param3.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_all_arrays" title="model.PSBL_PhotAstrom_Par_Param3.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_amp_arr" title="model.PSBL_PhotAstrom_Par_Param3.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_amplification" title="model.PSBL_PhotAstrom_Par_Param3.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_astrometry" title="model.PSBL_PhotAstrom_Par_Param3.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_Par_Param3.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_centroid" title="model.PSBL_PhotAstrom_Par_Param3.get_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid</span></code></a>(t_obs[, ast_filt_idx, ...])</p></td>
<td><p>PSPL: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_centroid_shift" title="model.PSBL_PhotAstrom_Par_Param3.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_complex_pos" title="model.PSBL_PhotAstrom_Par_Param3.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_image_pos_arr" title="model.PSBL_PhotAstrom_Par_Param3.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_image_pos_arr_old" title="model.PSBL_PhotAstrom_Par_Param3.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param3.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_photometry" title="model.PSBL_PhotAstrom_Par_Param3.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_amplification" title="model.PSBL_PhotAstrom_Par_Param3.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_astrometry" title="model.PSBL_PhotAstrom_Par_Param3.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param3.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_photometry" title="model.PSBL_PhotAstrom_Par_Param3.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param3.rescale_complex_pos" title="model.PSBL_PhotAstrom_Par_Param3.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.calc_piE_ecliptic">
<span class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.calc_piE_ecliptic" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, shape = len(t_obs) x 2</span></dt><dd><p>The unlensed positions of the source in arcseconds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_centroid">
<span class="sig-name descname"><span class="pre">get_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_centroid" title="Permalink to this definition"></a></dt>
<dd><p>PSPL: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array or float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Centroid offset on the plane of the sky in milli-arcseoncds.</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ast_filt_idx</strong><span class="classifier">int</span></dt><dd><p>Index into the photometry parameter lists for the photometry that
corresponds to this astrometry data set.</p>
</dd>
<dt><strong>image_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param3.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param3.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_PhotAstrom_Par_Param4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstromParam4.html#model.PSBL_PhotAstromParam4" title="model.PSBL_PhotAstromParam4"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam4</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.animate" title="model.PSBL_PhotAstrom_Par_Param4.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.calc_piE_ecliptic" title="model.PSBL_PhotAstrom_Par_Param4.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_all_arrays" title="model.PSBL_PhotAstrom_Par_Param4.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_amp_arr" title="model.PSBL_PhotAstrom_Par_Param4.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_amplification" title="model.PSBL_PhotAstrom_Par_Param4.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_astrometry" title="model.PSBL_PhotAstrom_Par_Param4.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_Par_Param4.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_centroid" title="model.PSBL_PhotAstrom_Par_Param4.get_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid</span></code></a>(t_obs[, ast_filt_idx, ...])</p></td>
<td><p>PSPL: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_centroid_shift" title="model.PSBL_PhotAstrom_Par_Param4.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_complex_pos" title="model.PSBL_PhotAstrom_Par_Param4.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_image_pos_arr" title="model.PSBL_PhotAstrom_Par_Param4.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_image_pos_arr_old" title="model.PSBL_PhotAstrom_Par_Param4.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param4.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_photometry" title="model.PSBL_PhotAstrom_Par_Param4.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_amplification" title="model.PSBL_PhotAstrom_Par_Param4.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_astrometry" title="model.PSBL_PhotAstrom_Par_Param4.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_Par_Param4.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_photometry" title="model.PSBL_PhotAstrom_Par_Param4.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_Param4.rescale_complex_pos" title="model.PSBL_PhotAstrom_Par_Param4.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.calc_piE_ecliptic">
<span class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.calc_piE_ecliptic" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, shape = len(t_obs) x 2</span></dt><dd><p>The unlensed positions of the source in arcseconds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_centroid">
<span class="sig-name descname"><span class="pre">get_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_centroid" title="Permalink to this definition"></a></dt>
<dd><p>PSPL: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array or float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Centroid offset on the plane of the sky in milli-arcseoncds.</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ast_filt_idx</strong><span class="classifier">int</span></dt><dd><p>Index into the photometry parameter lists for the photometry that
corresponds to this astrometry data set.</p>
</dd>
<dt><strong>image_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_Param4.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_Param4.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="psbl-phot">
<h2>PSBL_Phot<a class="headerlink" href="#psbl-phot" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_Phot_noPar_Param1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSBL_Phot.html#model.PSBL_Phot" title="model.PSBL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSBL_noParallax.html#model.PSBL_noParallax" title="model.PSBL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_noParallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotParam1.html#model.PSBL_PhotParam1" title="model.PSBL_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.animate" title="model.PSBL_Phot_noPar_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_all_arrays" title="model.PSBL_Phot_noPar_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_amp_arr" title="model.PSBL_Phot_noPar_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_amplification" title="model.PSBL_Phot_noPar_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_astrometry" title="model.PSBL_Phot_noPar_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in Einstein radii.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_astrometry_unlensed" title="model.PSBL_Phot_noPar_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_complex_pos" title="model.PSBL_Phot_noPar_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_image_pos_arr" title="model.PSBL_Phot_noPar_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_image_pos_arr_old" title="model.PSBL_Phot_noPar_Param1.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_photometry" title="model.PSBL_Phot_noPar_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_resolved_astrometry" title="model.PSBL_Phot_noPar_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in Einstein radii.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_resolved_lens_astrometry" title="model.PSBL_Phot_noPar_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.get_resolved_photometry" title="model.PSBL_Phot_noPar_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_Param1.rescale_complex_pos" title="model.PSBL_Phot_noPar_Param1.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.
Note, this is a photometry only model, so units are in Einstein radii.</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl>
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">len(t_obs)</span> <span class="pre">x</span> <span class="pre">2</span></code></span></dt><dd><p>The unlensed positions of the source in Einstein radii.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note, this is a photometry only model, so units are in Einstein radii.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as complex numbers.</p>
<p>This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note, this is a photometry only model, so units are in Einstein radii.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_Param1.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_Param1.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="psbl-phot-parallax">
<h2>PSBL_phot_parallax<a class="headerlink" href="#psbl-phot-parallax" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_Phot_Par_Param1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSBL_Phot.html#model.PSBL_Phot" title="model.PSBL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotParam1.html#model.PSBL_PhotParam1" title="model.PSBL_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.animate" title="model.PSBL_Phot_Par_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.calc_piE_ecliptic" title="model.PSBL_Phot_Par_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_all_arrays" title="model.PSBL_Phot_Par_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_amp_arr" title="model.PSBL_Phot_Par_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_amplification" title="model.PSBL_Phot_Par_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_astrometry" title="model.PSBL_Phot_Par_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in Einstein radii.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_astrometry_unlensed" title="model.PSBL_Phot_Par_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_complex_pos" title="model.PSBL_Phot_Par_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_image_pos_arr" title="model.PSBL_Phot_Par_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_image_pos_arr_old" title="model.PSBL_Phot_Par_Param1.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_photometry" title="model.PSBL_Phot_Par_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_resolved_astrometry" title="model.PSBL_Phot_Par_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in Einstein radii.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_resolved_lens_astrometry" title="model.PSBL_Phot_Par_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.get_resolved_photometry" title="model.PSBL_Phot_Par_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_Param1.rescale_complex_pos" title="model.PSBL_Phot_Par_Param1.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.calc_piE_ecliptic">
<span class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.calc_piE_ecliptic" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.
Note, this is a photometry only model, so units are in Einstein radii.</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl>
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">len(t_obs)</span> <span class="pre">x</span> <span class="pre">2</span></code></span></dt><dd><p>The unlensed positions of the source in Einstein radii.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note, this is a photometry only model, so units are in Einstein radii.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as complex numbers.</p>
<p>This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note, this is a photometry only model, so units are in Einstein radii.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_Param1.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_Param1.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="psbl-photastrom-no-parallax-with-gp">
<h2>PSBL PhotAstrom, no parallax with GP<a class="headerlink" href="#psbl-photastrom-no-parallax-with-gp" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_PhotAstrom_noPar_GP_Param1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSPL_GP.html#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_noParallax.html#model.PSBL_noParallax" title="model.PSBL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_noParallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstromParam1.html#model.PSBL_PhotAstromParam1" title="model.PSBL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.animate" title="model.PSBL_PhotAstrom_noPar_GP_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_all_arrays" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_amp_arr" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_amplification" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_centroid" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid</span></code></a>(t_obs[, ast_filt_idx, ...])</p></td>
<td><p>PSPL: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_centroid_shift" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t)</p></td>
<td><p>noParallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_complex_pos" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_image_pos_arr" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_image_pos_arr_old" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_log_det_covariance" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, ...)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry_with_gp" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, ...)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_amplification" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_photometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.log_likely_photometry" title="model.PSBL_PhotAstrom_noPar_GP_Param1.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, ...[, ...])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.rescale_complex_pos" title="model.PSBL_PhotAstrom_noPar_GP_Param1.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, shape = len(t_obs) x 2</span></dt><dd><p>The unlensed positions of the source in arcseconds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_centroid">
<span class="sig-name descname"><span class="pre">get_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_centroid" title="Permalink to this definition"></a></dt>
<dd><p>PSPL: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array or float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Centroid offset on the plane of the sky in milli-arcseoncds.</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ast_filt_idx</strong><span class="classifier">int</span></dt><dd><p>Index into the photometry parameter lists for the photometry that
corresponds to this astrometry data set.</p>
</dd>
<dt><strong>image_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_log_det_covariance">
<span class="sig-name descname"><span class="pre">get_log_det_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_log_det_covariance" title="Permalink to this definition"></a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will throw an error if this is a filter with <cite>use_gp_phot[filt_index] = False</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry_with_gp">
<span class="sig-name descname"><span class="pre">get_photometry_with_gp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_photometry_with_gp" title="Permalink to this definition"></a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will throw an error if this is a filter with <cite>use_gp_phot[filt_index] = False</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.log_likely_photometry">
<span class="sig-name descname"><span class="pre">log_likely_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.log_likely_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The GP will only be used for filters where <cite>use_gp_phot[filt_index] = True</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param1.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param1.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_PhotAstrom_noPar_GP_Param2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSPL_GP.html#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_noParallax.html#model.PSBL_noParallax" title="model.PSBL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_noParallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstromParam2.html#model.PSBL_PhotAstromParam2" title="model.PSBL_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.animate" title="model.PSBL_PhotAstrom_noPar_GP_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_all_arrays" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_amp_arr" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_amplification" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_centroid" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid</span></code></a>(t_obs[, ast_filt_idx, ...])</p></td>
<td><p>PSPL: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_centroid_shift" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t)</p></td>
<td><p>noParallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_complex_pos" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_image_pos_arr" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_image_pos_arr_old" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_log_det_covariance" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, ...)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry_with_gp" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, ...)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_amplification" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_photometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.log_likely_photometry" title="model.PSBL_PhotAstrom_noPar_GP_Param2.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, ...[, ...])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.rescale_complex_pos" title="model.PSBL_PhotAstrom_noPar_GP_Param2.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, shape = len(t_obs) x 2</span></dt><dd><p>The unlensed positions of the source in arcseconds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_centroid">
<span class="sig-name descname"><span class="pre">get_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_centroid" title="Permalink to this definition"></a></dt>
<dd><p>PSPL: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array or float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Centroid offset on the plane of the sky in milli-arcseoncds.</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ast_filt_idx</strong><span class="classifier">int</span></dt><dd><p>Index into the photometry parameter lists for the photometry that
corresponds to this astrometry data set.</p>
</dd>
<dt><strong>image_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_log_det_covariance">
<span class="sig-name descname"><span class="pre">get_log_det_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_log_det_covariance" title="Permalink to this definition"></a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will throw an error if this is a filter with <cite>use_gp_phot[filt_index] = False</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry_with_gp">
<span class="sig-name descname"><span class="pre">get_photometry_with_gp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_photometry_with_gp" title="Permalink to this definition"></a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will throw an error if this is a filter with <cite>use_gp_phot[filt_index] = False</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.log_likely_photometry">
<span class="sig-name descname"><span class="pre">log_likely_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.log_likely_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The GP will only be used for filters where <cite>use_gp_phot[filt_index] = True</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_noPar_GP_Param2.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_noPar_GP_Param2.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="psbl-photastrom-parallax-with-gp">
<h2>PSBL PhotAstrom, parallax with GP<a class="headerlink" href="#psbl-photastrom-parallax-with-gp" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_PhotAstrom_Par_GP_Param1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSPL_GP.html#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstromParam1.html#model.PSBL_PhotAstromParam1" title="model.PSBL_PhotAstromParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.animate" title="model.PSBL_PhotAstrom_Par_GP_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.calc_piE_ecliptic" title="model.PSBL_PhotAstrom_Par_GP_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_all_arrays" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_amp_arr" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_amplification" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_centroid" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid</span></code></a>(t_obs[, ast_filt_idx, ...])</p></td>
<td><p>PSPL: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_centroid_shift" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_complex_pos" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_image_pos_arr" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_image_pos_arr_old" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_lens_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_log_det_covariance" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, ...)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry_with_gp" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, ...)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_amplification" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_photometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.log_likely_photometry" title="model.PSBL_PhotAstrom_Par_GP_Param1.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, ...[, ...])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param1.rescale_complex_pos" title="model.PSBL_PhotAstrom_Par_GP_Param1.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.calc_piE_ecliptic">
<span class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.calc_piE_ecliptic" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, shape = len(t_obs) x 2</span></dt><dd><p>The unlensed positions of the source in arcseconds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_centroid">
<span class="sig-name descname"><span class="pre">get_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_centroid" title="Permalink to this definition"></a></dt>
<dd><p>PSPL: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array or float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Centroid offset on the plane of the sky in milli-arcseoncds.</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ast_filt_idx</strong><span class="classifier">int</span></dt><dd><p>Index into the photometry parameter lists for the photometry that
corresponds to this astrometry data set.</p>
</dd>
<dt><strong>image_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_log_det_covariance">
<span class="sig-name descname"><span class="pre">get_log_det_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_log_det_covariance" title="Permalink to this definition"></a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will throw an error if this is a filter with <cite>use_gp_phot[filt_index] = False</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry_with_gp">
<span class="sig-name descname"><span class="pre">get_photometry_with_gp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_photometry_with_gp" title="Permalink to this definition"></a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will throw an error if this is a filter with <cite>use_gp_phot[filt_index] = False</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.log_likely_photometry">
<span class="sig-name descname"><span class="pre">log_likely_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.log_likely_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The GP will only be used for filters where <cite>use_gp_phot[filt_index] = True</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param1.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param1.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_PhotAstrom_Par_GP_Param2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSPL_GP.html#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom" title="model.PSBL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstrom</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotAstromParam2.html#model.PSBL_PhotAstromParam2" title="model.PSBL_PhotAstromParam2"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotAstromParam2</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.animate" title="model.PSBL_PhotAstrom_Par_GP_Param2.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.calc_piE_ecliptic" title="model.PSBL_PhotAstrom_Par_GP_Param2.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_all_arrays" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_amp_arr" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_amplification" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry_unlensed" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_centroid" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid</span></code></a>(t_obs[, ast_filt_idx, ...])</p></td>
<td><p>PSPL: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_centroid_shift" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_centroid_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_shift</span></code></a>(t[, ast_filt_idx])</p></td>
<td><p>Parallax: Get the centroid shift (in mas) for a list of observation times (in MJD).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_complex_pos" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_image_pos_arr" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_image_pos_arr_old" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_lens_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lens system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_log_det_covariance" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, ...)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry_with_gp" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, ...)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_amplification" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_amplification</span></code></a>(t)</p></td>
<td><p>Parallax: Get the photometric amplification term at a set of times, t for both the plus and minus images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in arcsec.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_photometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.log_likely_photometry" title="model.PSBL_PhotAstrom_Par_GP_Param2.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, ...[, ...])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_PhotAstrom_Par_GP_Param2.rescale_complex_pos" title="model.PSBL_PhotAstrom_Par_GP_Param2.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_chi2_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.calc_piE_ecliptic">
<span class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.calc_piE_ecliptic" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, shape = len(t_obs) x 2</span></dt><dd><p>The unlensed positions of the source in arcseconds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_centroid">
<span class="sig-name descname"><span class="pre">get_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_centroid" title="Permalink to this definition"></a></dt>
<dd><p>PSPL: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array or float</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Centroid offset on the plane of the sky in milli-arcseoncds.</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ast_filt_idx</strong><span class="classifier">int</span></dt><dd><p>Index into the photometry parameter lists for the photometry that
corresponds to this astrometry data set.</p>
</dd>
<dt><strong>image_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">list</span></dt><dd><p>List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_log_det_covariance">
<span class="sig-name descname"><span class="pre">get_log_det_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_log_det_covariance" title="Permalink to this definition"></a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will throw an error if this is a filter with <cite>use_gp_phot[filt_index] = False</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry_with_gp">
<span class="sig-name descname"><span class="pre">get_photometry_with_gp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_photometry_with_gp" title="Permalink to this definition"></a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will throw an error if this is a filter with <cite>use_gp_phot[filt_index] = False</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.log_likely_photometry">
<span class="sig-name descname"><span class="pre">log_likely_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.log_likely_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The GP will only be used for filters where <cite>use_gp_phot[filt_index] = True</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_PhotAstrom_Par_GP_Param2.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom_Par_GP_Param2.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="psbl-phot-no-parallax-with-gp">
<h2>PSBL Phot, no parallax with GP<a class="headerlink" href="#psbl-phot-no-parallax-with-gp" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_Phot_noPar_GP_Param1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSPL_GP.html#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="api/model.PSBL_Phot.html#model.PSBL_Phot" title="model.PSBL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSBL_noParallax.html#model.PSBL_noParallax" title="model.PSBL_noParallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_noParallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotParam1.html#model.PSBL_PhotParam1" title="model.PSBL_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.animate" title="model.PSBL_Phot_noPar_GP_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_all_arrays" title="model.PSBL_Phot_noPar_GP_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_amp_arr" title="model.PSBL_Phot_noPar_GP_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_amplification" title="model.PSBL_Phot_noPar_GP_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_astrometry" title="model.PSBL_Phot_noPar_GP_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in Einstein radii.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_astrometry_unlensed" title="model.PSBL_Phot_noPar_GP_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_complex_pos" title="model.PSBL_Phot_noPar_GP_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_image_pos_arr" title="model.PSBL_Phot_noPar_GP_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_image_pos_arr_old" title="model.PSBL_Phot_noPar_GP_Param1.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_log_det_covariance" title="model.PSBL_Phot_noPar_GP_Param1.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, ...)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_photometry" title="model.PSBL_Phot_noPar_GP_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_photometry_with_gp" title="model.PSBL_Phot_noPar_GP_Param1.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, ...)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_resolved_astrometry" title="model.PSBL_Phot_noPar_GP_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in Einstein radii.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_resolved_lens_astrometry" title="model.PSBL_Phot_noPar_GP_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.get_resolved_photometry" title="model.PSBL_Phot_noPar_GP_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.log_likely_photometry" title="model.PSBL_Phot_noPar_GP_Param1.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, ...[, ...])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_noPar_GP_Param1.rescale_complex_pos" title="model.PSBL_Phot_noPar_GP_Param1.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>calc_piE_ecliptic</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.
Note, this is a photometry only model, so units are in Einstein radii.</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl>
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">len(t_obs)</span> <span class="pre">x</span> <span class="pre">2</span></code></span></dt><dd><p>The unlensed positions of the source in Einstein radii.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note, this is a photometry only model, so units are in Einstein radii.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as complex numbers.</p>
<p>This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_log_det_covariance">
<span class="sig-name descname"><span class="pre">get_log_det_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_log_det_covariance" title="Permalink to this definition"></a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will throw an error if this is a filter with <cite>use_gp_phot[filt_index] = False</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_photometry_with_gp">
<span class="sig-name descname"><span class="pre">get_photometry_with_gp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_photometry_with_gp" title="Permalink to this definition"></a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will throw an error if this is a filter with <cite>use_gp_phot[filt_index] = False</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note, this is a photometry only model, so units are in Einstein radii.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.log_likely_photometry">
<span class="sig-name descname"><span class="pre">log_likely_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.log_likely_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The GP will only be used for filters where <cite>use_gp_phot[filt_index] = True</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_noPar_GP_Param1.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_noPar_GP_Param1.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="psbl-phot-parallax-with-gp">
<h2>PSBL Phot, parallax with GP<a class="headerlink" href="#psbl-phot-parallax-with-gp" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">model.</span></span><span class="sig-name descname"><span class="pre">PSBL_Phot_Par_GP_Param1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSPL_GP.html#model.PSPL_GP" title="model.PSPL_GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_GP</span></code></a>, <a class="reference internal" href="api/model.PSBL_Phot.html#model.PSBL_Phot" title="model.PSBL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Phot</span></code></a>, <a class="reference internal" href="api/model.PSBL_Parallax.html#model.PSBL_Parallax" title="model.PSBL_Parallax"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_Parallax</span></code></a>, <a class="reference internal" href="api/model.PSBL_PhotParam1.html#model.PSBL_PhotParam1" title="model.PSBL_PhotParam1"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL_PhotParam1</span></code></a></p>
<p>An abstract class that all Param classes should sub-class.
This serves as a reminder for the class variables that
MUST be set.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.animate" title="model.PSBL_Phot_Par_GP_Param1.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE, time_steps, frame_time, name, ...)</p></td>
<td><p>Produces animation of microlensing event.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.calc_piE_ecliptic" title="model.PSBL_Phot_Par_GP_Param1.calc_piE_ecliptic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_piE_ecliptic</span></code></a>()</p></td>
<td><p>Parallax: Get piE_ecliptic</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_all_arrays" title="model.PSBL_Phot_Par_GP_Param1.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[, check_sols, rescale])</p></td>
<td><p>Obtain the image and amplitude arrays for each t_obs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_amp_arr" title="model.PSBL_Phot_Par_GP_Param1.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr, z1, z2)</p></td>
<td><p>Calculations amplification array</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_amplification" title="model.PSBL_Phot_Par_GP_Param1.get_amplification"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amplification</span></code></a>(t_obs[, amp_arr])</p></td>
<td><p>noParallax: Get the photometric amplification term at a set of times, t.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_astrometry" title="model.PSBL_Phot_Par_GP_Param1.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[, image_arr, amp_arr, ...])</p></td>
<td><p>Position of the observed (unresolved) source position in Einstein radii.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_astrometry_unlensed" title="model.PSBL_Phot_Par_GP_Param1.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</p></td>
<td><p>Get the astrometry of the source if the lens didn't exist.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_complex_pos" title="model.PSBL_Phot_Par_GP_Param1.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</p></td>
<td><p>Get the positions of the lenses and source as complex numbers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_image_pos_arr" title="model.PSBL_Phot_Par_GP_Param1.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w, z1, z2, m1, m2[, ...])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_image_pos_arr_old" title="model.PSBL_Phot_Par_GP_Param1.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w, z1, z2[, check_sols])</p></td>
<td><p>Gets image positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_log_det_covariance" title="model.PSBL_Phot_Par_GP_Param1.get_log_det_covariance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_det_covariance</span></code></a>(t_obs, mag_obs, ...)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_photometry" title="model.PSBL_Phot_Par_GP_Param1.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[, filt_idx, amp_arr, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_photometry_with_gp" title="model.PSBL_Phot_Par_GP_Param1.get_photometry_with_gp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry_with_gp</span></code></a>(t_obs, mag_obs, ...)</p></td>
<td><p>Returns photometry with GP noise added in.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_resolved_astrometry" title="model.PSBL_Phot_Par_GP_Param1.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[, image_arr, ...])</p></td>
<td><p>Position of the observed source position in Einstein radii.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_resolved_lens_astrometry" title="model.PSBL_Phot_Par_GP_Param1.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</p></td>
<td><p>Equation of motion for just the foreground lenses, individually.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.get_resolved_photometry" title="model.PSBL_Phot_Par_GP_Param1.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[, filt_idx, ...])</p></td>
<td><p>Get the photometry for each of the lensed source images.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.log_likely_photometry" title="model.PSBL_Phot_Par_GP_Param1.log_likely_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likely_photometry</span></code></a>(t_obs, mag_obs, ...[, ...])</p></td>
<td><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#model.PSBL_Phot_Par_GP_Param1.rescale_complex_pos" title="model.PSBL_Phot_Par_GP_Param1.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w, z1, z2)</p></td>
<td><p>Make sure everything is roughly centered on the origin in a 1 x 1 box.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 75%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>get_centroid_shift</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_chi2_photometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_lens_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_lnL_constant</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_resolved_amplification</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>log_likely_astrometry</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>log_likely_photometry_each</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>start</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.animate">
<span class="sig-name descname"><span class="pre">animate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrometry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.animate" title="Permalink to this definition"></a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tE:</strong></dt><dd><dl class="simple">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt><dd><p>e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt><dd><p>number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt><dd><p>times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt><dd><p>the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt><dd><p>[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt><dd><p># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.calc_piE_ecliptic">
<span class="sig-name descname"><span class="pre">calc_piE_ecliptic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.calc_piE_ecliptic" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get piE_ecliptic</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_all_arrays">
<span class="sig-name descname"><span class="pre">get_all_arrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_all_arrays" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>images</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_amp_arr">
<span class="sig-name descname"><span class="pre">get_amp_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_amp_arr" title="Permalink to this definition"></a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><div class="line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>amp_arr</strong><span class="classifier">array_like</span></dt><dd><p>BLEH</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_amplification">
<span class="sig-name descname"><span class="pre">get_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_amplification" title="Permalink to this definition"></a></dt>
<dd><p>noParallax: Get the photometric amplification term at a set of times, t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_astrometry">
<span class="sig-name descname"><span class="pre">get_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed (unresolved) source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_astrometry_unlensed">
<span class="sig-name descname"><span class="pre">get_astrometry_unlensed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_astrometry_unlensed" title="Permalink to this definition"></a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.
Note, this is a photometry only model, so units are in Einstein radii.</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl>
<dt><strong>xS_unlensed</strong><span class="classifier">numpy array, dtype=float, <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">len(t_obs)</span> <span class="pre">x</span> <span class="pre">2</span></code></span></dt><dd><p>The unlensed positions of the source in Einstein radii.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note, this is a photometry only model, so units are in Einstein radii.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_centroid_shift">
<span class="sig-name descname"><span class="pre">get_centroid_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ast_filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_centroid_shift" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_complex_pos">
<span class="sig-name descname"><span class="pre">get_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Get the positions of the lenses and source as complex numbers.</p>
<p>This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">complex array</span></dt><dd><p>Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong><span class="classifier">complex array</span></dt><dd><p>Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong><span class="classifier">complex array</span></dt><dd><p>Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_image_pos_arr">
<span class="sig-name descname"><span class="pre">get_image_pos_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_image_pos_arr" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_image_pos_arr_old">
<span class="sig-name descname"><span class="pre">get_image_pos_arr_old</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_sols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_image_pos_arr_old" title="Permalink to this definition"></a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>w</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong><span class="classifier">array_like</span></dt><dd><p>Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z_arr</strong><span class="classifier">array_like</span></dt><dd><p>Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get lens astrometry</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_log_det_covariance">
<span class="sig-name descname"><span class="pre">get_log_det_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_log_det_covariance" title="Permalink to this definition"></a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will throw an error if this is a filter with <cite>use_gp_phot[filt_index] = False</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_photometry">
<span class="sig-name descname"><span class="pre">get_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_photometry_with_gp">
<span class="sig-name descname"><span class="pre">get_photometry_with_gp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_photometry_with_gp" title="Permalink to this definition"></a></dt>
<dd><p>Returns photometry with GP noise added in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will throw an error if this is a filter with <cite>use_gp_phot[filt_index] = False</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_resolved_amplification">
<span class="sig-name descname"><span class="pre">get_resolved_amplification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_resolved_amplification" title="Permalink to this definition"></a></dt>
<dd><p>Parallax: Get the photometric amplification term at a set of times, t for both the
plus and minus images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t:</strong></dt><dd><p>Array of times in MJD.DDD</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_resolved_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_resolved_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Position of the observed source position in Einstein radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like, shape = [N_times]</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model_pos</strong><span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt><dd><p>Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_resolved_lens_astrometry">
<span class="sig-name descname"><span class="pre">get_resolved_lens_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_resolved_lens_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Time (in MJD).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note, this is a photometry only model, so units are in Einstein radii.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.get_resolved_photometry">
<span class="sig-name descname"><span class="pre">get_resolved_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.get_resolved_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_obs</strong><span class="classifier">array_like</span></dt><dd><p>Array of times to model.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag_model</strong><span class="classifier">array_like</span></dt><dd><p>Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.log_likely_photometry">
<span class="sig-name descname"><span class="pre">log_likely_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.log_likely_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the log-likelihood for the PSPL + GP model and photometric data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The GP will only be used for filters where <cite>use_gp_phot[filt_index] = True</cite>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="model.PSBL_Phot_Par_GP_Param1.rescale_complex_pos">
<span class="sig-name descname"><span class="pre">rescale_complex_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot_Par_GP_Param1.rescale_complex_pos" title="Permalink to this definition"></a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="PSPL_User.html" class="btn btn-neutral float-left" title="PSPL User Classes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="FSPL_User.html" class="btn btn-neutral float-right" title="FSPL User Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Niranjan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>