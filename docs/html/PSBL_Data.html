<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data Class Family &mdash; BAGLE 0.1 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="POINT SOURCE BINARY LENS (PSBL) CLASSES" href="PSBL.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> BAGLE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">BAGLE TUTORIAL</a></li>
<li class="toctree-l1"><a class="reference internal" href="model3.html">Model.py Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="UserClass.html">User Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="PSPL.html">POINT SOURCE POINT LENS (PSPL) CLASSES</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="PSBL.html">POINT SOURCE BINARY LENS (PSBL) CLASSES</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Data Class Family</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="PSBL_Parallax.html">Parallax Class Family - PSBL</a></li>
<li class="toctree-l2"><a class="reference internal" href="PSBL_Param.html">Parameterization Class Family - PSBL</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="BSPL.html">BINARY SOURCE POINT LENS (BSPL) CLASSES</a></li>
<li class="toctree-l1"><a class="reference internal" href="FSPL.html">FSPL(Finite-Source Point Lens) Models - NOT DONE YET… place holders</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gen_Use.html">GENERAL USE AND SHARED FUNCTIONS</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_fitter.html">Model Fitter</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BAGLE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="PSBL.html">POINT SOURCE BINARY LENS (PSBL) CLASSES</a> &raquo;</li>
      <li>Data Class Family</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/PSBL_Data.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="data-class-family">
<h1>Data Class Family<a class="headerlink" href="#data-class-family" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="model.PSBL">
<em class="property">class </em><code class="descclassname">model.</code><code class="descname">PSBL</code><a class="headerlink" href="#model.PSBL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSPL.html#model.PSPL" title="model.PSPL"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL</span></code></a></p>
<p>Contains methods for model a PSBL photometry + astrometry.
This is a Data-type class in our hierarchy. It is abstract and should not
be instantiated.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#model.PSBL.animate" title="model.PSBL.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE,&nbsp;time_steps,&nbsp;frame_time,&nbsp;name,&nbsp;…)</td>
<td>Produces animation of microlensing event.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/model.PSBL.html#model.PSBL.get_all_arrays" title="model.PSBL.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[,&nbsp;check_sols,&nbsp;rescale])</td>
<td>Obtain the image and amplitude arrays for each t_obs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="api/model.PSBL.html#model.PSBL.get_amp_arr" title="model.PSBL.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr,&nbsp;z1,&nbsp;z2)</td>
<td>Calculations amplification array</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/model.PSBL.html#model.PSBL.get_image_pos_arr" title="model.PSBL.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w,&nbsp;z1,&nbsp;z2,&nbsp;m1,&nbsp;m2[,&nbsp;…])</td>
<td>Gets image positions.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#model.PSBL.get_image_pos_arr_old" title="model.PSBL.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w,&nbsp;z1,&nbsp;z2[,&nbsp;check_sols])</td>
<td>Gets image positions.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/model.PSBL.html#model.PSBL.get_photometry" title="model.PSBL.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[,&nbsp;filt_idx,&nbsp;amp_arr,&nbsp;…])</td>
<td>Get the photometry for each of the lensed source images.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="api/model.PSBL.html#model.PSBL.get_resolved_photometry" title="model.PSBL.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[,&nbsp;filt_idx,&nbsp;…])</td>
<td>Get the photometry for each of the lensed source images.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#model.PSBL.rescale_complex_pos" title="model.PSBL.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w,&nbsp;z1,&nbsp;z2)</td>
<td>Make sure everything is roughly centered on the origin in a 1 x 1 box.</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="75%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>get_chi2_photometry</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>get_lnL_constant</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>log_likely_photometry</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>log_likely_photometry_each</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="model.PSBL.get_amp_arr">
<code class="descname">get_amp_arr</code><span class="sig-paren">(</span><em>z_arr</em>, <em>z1</em>, <em>z2</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>z_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><div class="first last line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>amp_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">BLEH</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL.rescale_complex_pos">
<code class="descname">rescale_complex_pos</code><span class="sig-paren">(</span><em>w</em>, <em>z1</em>, <em>z2</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.rescale_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

<dl class="method">
<dt id="model.PSBL.get_image_pos_arr_old">
<code class="descname">get_image_pos_arr_old</code><span class="sig-paren">(</span><em>w</em>, <em>z1</em>, <em>z2</em>, <em>check_sols=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.get_image_pos_arr_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>w</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>z_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL.get_image_pos_arr">
<code class="descname">get_image_pos_arr</code><span class="sig-paren">(</span><em>w</em>, <em>z1</em>, <em>z2</em>, <em>m1</em>, <em>m2</em>, <em>check_sols=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>w</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>z_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL.get_all_arrays">
<code class="descname">get_all_arrays</code><span class="sig-paren">(</span><em>t_obs</em>, <em>check_sols=True</em>, <em>rescale=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of times to model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>images</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL.get_resolved_photometry">
<code class="descname">get_resolved_photometry</code><span class="sig-paren">(</span><em>t_obs</em>, <em>filt_idx=0</em>, <em>amp_arr=None</em>, <em>print_warning=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of times to model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mag_model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL.get_photometry">
<code class="descname">get_photometry</code><span class="sig-paren">(</span><em>t_obs</em>, <em>filt_idx=0</em>, <em>amp_arr=None</em>, <em>print_warning=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of times to model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mag_model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL.animate">
<code class="descname">animate</code><span class="sig-paren">(</span><em>tE</em>, <em>time_steps</em>, <em>frame_time</em>, <em>name</em>, <em>size</em>, <em>zoom</em>, <em>astrometry</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>tE:</strong></dt>
<dd><dl class="first last docutils">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt>
<dd><p class="first last">e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt>
<dd><p class="first last">number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt>
<dd><p class="first last">times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt>
<dd><p class="first last">the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt>
<dd><p class="first last">[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt>
<dd><p class="first last"># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="model.PSBL_Phot">
<em class="property">class </em><code class="descclassname">model.</code><code class="descname">PSBL_Phot</code><a class="headerlink" href="#model.PSBL_Phot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSBL.html#model.PSBL" title="model.PSBL"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL</span></code></a>, <a class="reference internal" href="api/model.PSPL_Phot.html#model.PSPL_Phot" title="model.PSPL_Phot"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_Phot</span></code></a></p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#model.PSBL_Phot.animate" title="model.PSBL_Phot.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE,&nbsp;time_steps,&nbsp;frame_time,&nbsp;name,&nbsp;…)</td>
<td>Produces animation of microlensing event.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#model.PSBL_Phot.get_all_arrays" title="model.PSBL_Phot.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[,&nbsp;check_sols,&nbsp;rescale])</td>
<td>Obtain the image and amplitude arrays for each t_obs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#model.PSBL_Phot.get_amp_arr" title="model.PSBL_Phot.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr,&nbsp;z1,&nbsp;z2)</td>
<td>Calculations amplification array</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/model.PSBL_Phot.html#model.PSBL_Phot.get_astrometry" title="model.PSBL_Phot.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[,&nbsp;image_arr,&nbsp;amp_arr,&nbsp;…])</td>
<td>Position of the observed (unresolved) source position in Einstein radii.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="api/model.PSBL_Phot.html#model.PSBL_Phot.get_astrometry_unlensed" title="model.PSBL_Phot.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</td>
<td>Get the astrometry of the source if the lens didn’t exist.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/model.PSBL_Phot.html#model.PSBL_Phot.get_complex_pos" title="model.PSBL_Phot.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</td>
<td>Get the positions of the lenses and source as complex numbers.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#model.PSBL_Phot.get_image_pos_arr" title="model.PSBL_Phot.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w,&nbsp;z1,&nbsp;z2,&nbsp;m1,&nbsp;m2[,&nbsp;…])</td>
<td>Gets image positions.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#model.PSBL_Phot.get_image_pos_arr_old" title="model.PSBL_Phot.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w,&nbsp;z1,&nbsp;z2[,&nbsp;check_sols])</td>
<td>Gets image positions.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#model.PSBL_Phot.get_photometry" title="model.PSBL_Phot.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[,&nbsp;filt_idx,&nbsp;amp_arr,&nbsp;…])</td>
<td>Get the photometry for each of the lensed source images.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/model.PSBL_Phot.html#model.PSBL_Phot.get_resolved_astrometry" title="model.PSBL_Phot.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[,&nbsp;image_arr,&nbsp;…])</td>
<td>Position of the observed source position in Einstein radii.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="api/model.PSBL_Phot.html#model.PSBL_Phot.get_resolved_lens_astrometry" title="model.PSBL_Phot.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</td>
<td>Equation of motion for just the foreground lenses, individually.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#model.PSBL_Phot.get_resolved_photometry" title="model.PSBL_Phot.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[,&nbsp;filt_idx,&nbsp;…])</td>
<td>Get the photometry for each of the lensed source images.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#model.PSBL_Phot.rescale_complex_pos" title="model.PSBL_Phot.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w,&nbsp;z1,&nbsp;z2)</td>
<td>Make sure everything is roughly centered on the origin in a 1 x 1 box.</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="75%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>get_centroid_shift</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>get_chi2_photometry</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>get_lens_astrometry</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>get_lnL_constant</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>get_resolved_amplification</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>log_likely_astrometry</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>log_likely_photometry</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>log_likely_photometry_each</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="model.PSBL_Phot.get_complex_pos">
<code class="descname">get_complex_pos</code><span class="sig-paren">(</span><em>t_obs</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as complex numbers.</p>
<p>This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>w</strong> <span class="classifier-delimiter">:</span> <span class="classifier">complex array</span></dt>
<dd><p class="first last">Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">complex array</span></dt>
<dd><p class="first last">Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">complex array</span></dt>
<dd><p class="first last">Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_Phot.get_resolved_lens_astrometry">
<code class="descname">get_resolved_lens_astrometry</code><span class="sig-paren">(</span><em>t_obs</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Time (in MJD).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note, this is a photometry only model, so units are in Einstein radii.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_Phot.get_astrometry_unlensed">
<code class="descname">get_astrometry_unlensed</code><span class="sig-paren">(</span><em>t_obs</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.
Note, this is a photometry only model, so units are in Einstein radii.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>xS_unlensed</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array, dtype=float, <code class="docutils literal notranslate"><span class="pre">shape</span> <span class="pre">=</span> <span class="pre">len(t_obs)</span> <span class="pre">x</span> <span class="pre">2</span></code></span></dt>
<dd><p class="first last">The unlensed positions of the source in Einstein radii.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note, this is a photometry only model, so units are in Einstein radii.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_Phot.get_resolved_astrometry">
<code class="descname">get_resolved_astrometry</code><span class="sig-paren">(</span><em>t_obs</em>, <em>image_arr=None</em>, <em>amp_arr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in Einstein radii.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape = [N_times]</span></dt>
<dd><p class="first last">Array of times to model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>model_pos</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt>
<dd><p class="first last">Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_Phot.get_astrometry">
<code class="descname">get_astrometry</code><span class="sig-paren">(</span><em>t_obs</em>, <em>image_arr=None</em>, <em>amp_arr=None</em>, <em>ast_filt_idx=0</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in Einstein radii.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of times to model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>model_pos</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_Phot.animate">
<code class="descname">animate</code><span class="sig-paren">(</span><em>tE</em>, <em>time_steps</em>, <em>frame_time</em>, <em>name</em>, <em>size</em>, <em>zoom</em>, <em>astrometry</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>tE:</strong></dt>
<dd><dl class="first last docutils">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt>
<dd><p class="first last">e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt>
<dd><p class="first last">number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt>
<dd><p class="first last">times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt>
<dd><p class="first last">the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt>
<dd><p class="first last">[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt>
<dd><p class="first last"># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_Phot.get_all_arrays">
<code class="descname">get_all_arrays</code><span class="sig-paren">(</span><em>t_obs</em>, <em>check_sols=True</em>, <em>rescale=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of times to model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>images</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_Phot.get_amp_arr">
<code class="descname">get_amp_arr</code><span class="sig-paren">(</span><em>z_arr</em>, <em>z1</em>, <em>z2</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>z_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><div class="first last line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>amp_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">BLEH</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_Phot.get_image_pos_arr">
<code class="descname">get_image_pos_arr</code><span class="sig-paren">(</span><em>w</em>, <em>z1</em>, <em>z2</em>, <em>m1</em>, <em>m2</em>, <em>check_sols=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>w</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>z_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_Phot.get_image_pos_arr_old">
<code class="descname">get_image_pos_arr_old</code><span class="sig-paren">(</span><em>w</em>, <em>z1</em>, <em>z2</em>, <em>check_sols=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_image_pos_arr_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>w</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>z_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_Phot.get_photometry">
<code class="descname">get_photometry</code><span class="sig-paren">(</span><em>t_obs</em>, <em>filt_idx=0</em>, <em>amp_arr=None</em>, <em>print_warning=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of times to model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mag_model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_Phot.get_resolved_photometry">
<code class="descname">get_resolved_photometry</code><span class="sig-paren">(</span><em>t_obs</em>, <em>filt_idx=0</em>, <em>amp_arr=None</em>, <em>print_warning=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of times to model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mag_model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_Phot.rescale_complex_pos">
<code class="descname">rescale_complex_pos</code><span class="sig-paren">(</span><em>w</em>, <em>z1</em>, <em>z2</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_Phot.rescale_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="model.PSBL_PhotAstrom">
<em class="property">class </em><code class="descclassname">model.</code><code class="descname">PSBL_PhotAstrom</code><a class="headerlink" href="#model.PSBL_PhotAstrom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="api/model.PSBL.html#model.PSBL" title="model.PSBL"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSBL</span></code></a>, <a class="reference internal" href="api/model.PSPL_PhotAstrom.html#model.PSPL_PhotAstrom" title="model.PSPL_PhotAstrom"><code class="xref py py-class docutils literal notranslate"><span class="pre">model.PSPL_PhotAstrom</span></code></a></p>
<p>Contains methods for model a PSPL photometry + astrometry.
This is a Data-type class in our hierarchy. It is abstract and should not
be instantiated.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#model.PSBL_PhotAstrom.animate" title="model.PSBL_PhotAstrom.animate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">animate</span></code></a>(tE,&nbsp;time_steps,&nbsp;frame_time,&nbsp;name,&nbsp;…)</td>
<td>Produces animation of microlensing event.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#model.PSBL_PhotAstrom.get_all_arrays" title="model.PSBL_PhotAstrom.get_all_arrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_all_arrays</span></code></a>(t_obs[,&nbsp;check_sols,&nbsp;rescale])</td>
<td>Obtain the image and amplitude arrays for each t_obs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#model.PSBL_PhotAstrom.get_amp_arr" title="model.PSBL_PhotAstrom.get_amp_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp_arr</span></code></a>(z_arr,&nbsp;z1,&nbsp;z2)</td>
<td>Calculations amplification array</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom.get_astrometry" title="model.PSBL_PhotAstrom.get_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry</span></code></a>(t_obs[,&nbsp;image_arr,&nbsp;amp_arr,&nbsp;…])</td>
<td>Position of the observed (unresolved) source position in arcsec.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom.get_astrometry_unlensed" title="model.PSBL_PhotAstrom.get_astrometry_unlensed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_astrometry_unlensed</span></code></a>(t_obs)</td>
<td>Get the astrometry of the source if the lens didn’t exist.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#model.PSBL_PhotAstrom.get_centroid" title="model.PSBL_PhotAstrom.get_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid</span></code></a>(t_obs[,&nbsp;ast_filt_idx,&nbsp;…])</td>
<td>PSPL: Get the centroid shift (in mas) for a list of observation times (in MJD).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom.get_complex_pos" title="model.PSBL_PhotAstrom.get_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_complex_pos</span></code></a>(t_obs)</td>
<td>Get the positions of the lenses and source as complex numbers.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#model.PSBL_PhotAstrom.get_image_pos_arr" title="model.PSBL_PhotAstrom.get_image_pos_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr</span></code></a>(w,&nbsp;z1,&nbsp;z2,&nbsp;m1,&nbsp;m2[,&nbsp;…])</td>
<td>Gets image positions.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#model.PSBL_PhotAstrom.get_image_pos_arr_old" title="model.PSBL_PhotAstrom.get_image_pos_arr_old"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_image_pos_arr_old</span></code></a>(w,&nbsp;z1,&nbsp;z2[,&nbsp;check_sols])</td>
<td>Gets image positions.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom.get_lens_astrometry" title="model.PSBL_PhotAstrom.get_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lens_astrometry</span></code></a>(t_obs)</td>
<td>Equation of motion for just the foreground lens system.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#model.PSBL_PhotAstrom.get_photometry" title="model.PSBL_PhotAstrom.get_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_photometry</span></code></a>(t_obs[,&nbsp;filt_idx,&nbsp;amp_arr,&nbsp;…])</td>
<td>Get the photometry for each of the lensed source images.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom.get_resolved_astrometry" title="model.PSBL_PhotAstrom.get_resolved_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_astrometry</span></code></a>(t_obs[,&nbsp;image_arr,&nbsp;…])</td>
<td>Position of the observed source position in arcsec.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="api/model.PSBL_PhotAstrom.html#model.PSBL_PhotAstrom.get_resolved_lens_astrometry" title="model.PSBL_PhotAstrom.get_resolved_lens_astrometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_lens_astrometry</span></code></a>(t_obs)</td>
<td>Equation of motion for just the foreground lenses, individually.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#model.PSBL_PhotAstrom.get_resolved_photometry" title="model.PSBL_PhotAstrom.get_resolved_photometry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_resolved_photometry</span></code></a>(t_obs[,&nbsp;filt_idx,&nbsp;…])</td>
<td>Get the photometry for each of the lensed source images.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#model.PSBL_PhotAstrom.rescale_complex_pos" title="model.PSBL_PhotAstrom.rescale_complex_pos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rescale_complex_pos</span></code></a>(w,&nbsp;z1,&nbsp;z2)</td>
<td>Make sure everything is roughly centered on the origin in a 1 x 1 box.</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="75%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>get_chi2_astrometry</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>get_chi2_photometry</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>get_lnL_constant</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>log_likely_astrometry</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>log_likely_astrometry_each</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>log_likely_photometry</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>log_likely_photometry_each</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="model.PSBL_PhotAstrom.get_complex_pos">
<code class="descname">get_complex_pos</code><span class="sig-paren">(</span><em>t_obs</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the positions of the lenses and source as
complex numbers. This is needed for further calculations.
Note that all units are still the same as before, this
is just rewriting vectors <span class="math notranslate nohighlight">\(z = (x,y)\)</span> as <span class="math notranslate nohighlight">\(z = x + iy\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>w</strong> <span class="classifier-delimiter">:</span> <span class="classifier">complex array</span></dt>
<dd><p class="first last">Source position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">complex array</span></dt>
<dd><p class="first last">Lens primary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
<dt><strong>z2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">complex array</span></dt>
<dd><p class="first last">Lens secondary component position as an array of complex numbers with
real = east component, imaginary = north component</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.get_resolved_astrometry">
<code class="descname">get_resolved_astrometry</code><span class="sig-paren">(</span><em>t_obs</em>, <em>image_arr=None</em>, <em>amp_arr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_resolved_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed source position in arcsec.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like, shape = [N_times]</span></dt>
<dd><p class="first last">Array of times to model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>model_pos</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like. shape = [N_times, N_images, 2]</span></dt>
<dd><p class="first last">Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.get_astrometry">
<code class="descname">get_astrometry</code><span class="sig-paren">(</span><em>t_obs</em>, <em>image_arr=None</em>, <em>amp_arr=None</em>, <em>ast_filt_idx=0</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of the observed (unresolved) source position in arcsec.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of times to model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>model_pos</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of vector positions of the centroid at each t_obs.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.get_astrometry_unlensed">
<code class="descname">get_astrometry_unlensed</code><span class="sig-paren">(</span><em>t_obs</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_astrometry_unlensed" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the astrometry of the source if the lens didn’t exist.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>xS_unlensed</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array, dtype=float, shape = len(t_obs) x 2</span></dt>
<dd><p class="first last">The unlensed positions of the source in arcseconds.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.get_lens_astrometry">
<code class="descname">get_lens_astrometry</code><span class="sig-paren">(</span><em>t_obs</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lens system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Time (in MJD).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.get_resolved_lens_astrometry">
<code class="descname">get_resolved_lens_astrometry</code><span class="sig-paren">(</span><em>t_obs</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_resolved_lens_astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Equation of motion for just the foreground lenses, individually.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Time (in MJD).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.get_centroid">
<code class="descname">get_centroid</code><span class="sig-paren">(</span><em>t_obs</em>, <em>ast_filt_idx=0</em>, <em>image_arr=None</em>, <em>amp_arr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>PSPL: Get the centroid shift (in mas) for a list of
observation times (in MJD).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array or float</span></dt>
<dd></dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt>Centroid offset on the plane of the sky in milli-arcseoncds.</dt>
<dd></dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first last docutils">
<dt><strong>ast_filt_idx</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Index into the photometry parameter lists for the photometry that
corresponds to this astrometry data set.</p>
</dd>
<dt><strong>image_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
<dt><strong>amp_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">List returned from PSPL get_all_arrays() used to improve efficiency.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.animate">
<code class="descname">animate</code><span class="sig-paren">(</span><em>tE</em>, <em>time_steps</em>, <em>frame_time</em>, <em>name</em>, <em>size</em>, <em>zoom</em>, <em>astrometry</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces animation of microlensing event. 
This function takes the PSPL and makes an animation, the input variables are as follows</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>tE:</strong></dt>
<dd><dl class="first last docutils">
<dt>number of einstein crossings times before/after the peak you want the animation to plot</dt>
<dd><p class="first last">e.g tE = 2 =&gt; graph will go from -2 tE to 2 tE</p>
</dd>
</dl>
</dd>
<dt><strong>time_steps:</strong></dt>
<dd><p class="first last">number of time steps before/after peak, so total number of time steps will 
be 2 times this value</p>
</dd>
<dt><strong>frame_time:</strong></dt>
<dd><p class="first last">times in ms of each frame in the animation</p>
</dd>
<dt><strong>name: string</strong></dt>
<dd><p class="first last">the animation will be saved as name.html</p>
</dd>
<dt><strong>size: list</strong></dt>
<dd><p class="first last">[horizontal, vertical] cm’s</p>
</dd>
<dt><strong>zoom:</strong></dt>
<dd><p class="first last"># of einstein radii plotted in vertical direction</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.get_all_arrays">
<code class="descname">get_all_arrays</code><span class="sig-paren">(</span><em>t_obs</em>, <em>check_sols=True</em>, <em>rescale=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_all_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the image and amplitude arrays for each t_obs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of times to model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>images</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array/tuple of complex positions of each images at each t_obs.</p>
</dd>
<dt><strong>amp_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array/tuple of amplification of each images at each t_obs.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.get_amp_arr">
<code class="descname">get_amp_arr</code><span class="sig-paren">(</span><em>z_arr</em>, <em>z1</em>, <em>z2</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_amp_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculations amplification array</p>
<p>Calculates the amplification A from the Jacobian J, <span class="math notranslate nohighlight">\(A = 1/|J|\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>z_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><div class="first last line-block">
<div class="line">Complex position of images. <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">N_solutions,</span> <span class="pre">1]</span></code></div>
<div class="line">– note this could be jagged.</div>
</div>
</dd>
<dt><strong>z1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 1 (primary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
<dt><strong>z2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 2 (secondary). <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">=</span> <span class="pre">[N_times,</span> <span class="pre">1]</span></code></p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>amp_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">BLEH</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.get_image_pos_arr">
<code class="descname">get_image_pos_arr</code><span class="sig-paren">(</span><em>w</em>, <em>z1</em>, <em>z2</em>, <em>m1</em>, <em>m2</em>, <em>check_sols=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_image_pos_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets image positions.</p>
<div class="line-block">
<div class="line">Solve the fifth-order polynomial and get the image positions.</div>
<div class="line">See PSBL writeup for full equations.</div>
<div class="line">All angular distances are in arcsec.</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>w</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>z_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.get_image_pos_arr_old">
<code class="descname">get_image_pos_arr_old</code><span class="sig-paren">(</span><em>w</em>, <em>z1</em>, <em>z2</em>, <em>check_sols=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_image_pos_arr_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets image positions.
| Solve the fifth-order polynomial and get the image positions.
| See PSBL writeup for full equations.
| All angular distances are in arcsec.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>w</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of the source. Shape = [N_times, 1]</p>
</dd>
<dt><strong>z1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 1 (primary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>z2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Complex position(s) of lens 2 (secondary). Shape = [N_times, 1]</p>
</dd>
<dt><strong>check_sols</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If True, calculated roots are checked against the lens equation,
and output will only contain those within self.root_tol.
If False, all calculated roots are returned.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>z_arr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Rank-1 array of polynomial roots, possibly complex.
If check_sols = True, only roots solving the lens
equation are returned.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.get_photometry">
<code class="descname">get_photometry</code><span class="sig-paren">(</span><em>t_obs</em>, <em>filt_idx=0</em>, <em>amp_arr=None</em>, <em>print_warning=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of times to model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mag_model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Magnitude of the centroid at t_obs.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.get_resolved_photometry">
<code class="descname">get_resolved_photometry</code><span class="sig-paren">(</span><em>t_obs</em>, <em>filt_idx=0</em>, <em>amp_arr=None</em>, <em>print_warning=True</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.get_resolved_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the photometry for each of the lensed source images.
Implement with no blending (since we don’t support different
blendings for the different images).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t_obs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of times to model.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>mag_model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Magnitude of each lensed image centroid at t_obs.
Shape = [5, len(t_obs)]</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="model.PSBL_PhotAstrom.rescale_complex_pos">
<code class="descname">rescale_complex_pos</code><span class="sig-paren">(</span><em>w</em>, <em>z1</em>, <em>z2</em><span class="sig-paren">)</span><a class="headerlink" href="#model.PSBL_PhotAstrom.rescale_complex_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Make sure everything is roughly centered on the origin
in a 1 x 1 box.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="PSBL.html" class="btn btn-neutral float-left" title="POINT SOURCE BINARY LENS (PSBL) CLASSES" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Niranjan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>